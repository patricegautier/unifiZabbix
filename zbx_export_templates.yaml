zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 15155c95a3d048f4856272ae12fd42c5
      name: Patrice
    - uuid: e211bc7037224ae698133ce470303670
      name: Unifi
    - uuid: 0a316d3d60f64ef8aded36d48dd9d134
      name: unifiZabbix
    - uuid: 959165cff290432bbfbea50b4b247b0b
      name: 'Unifi Zabbix Export'
  templates:
    - uuid: 3992b5de5504463d9538197893b1fdbc
      template: 'SunMAX SolarPoint'
      name: 'SunMAX SolarPoint'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 304f50a34a7045dea1314f8317e25a7f
          name: 'Battery Charge'
          type: DEPENDENT
          key: batteryCharge
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.batteries[0].charge'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
          triggers:
            - uuid: 779c1fdbf6d848988411e38c8f70cc3e
              expression: 'last(/SunMAX SolarPoint/batteryCharge,#1)<2500'
              name: 'Battery Charge is below 25%'
              priority: WARNING
              dependencies:
                - name: 'Battery Charge is below 50%'
                  expression: 'last(/SunMAX SolarPoint/batteryCharge,#1)<5000'
            - uuid: 6b2607bd0add48f4bcf5e8a6aee1a517
              expression: 'last(/SunMAX SolarPoint/batteryCharge,#1)<5000'
              name: 'Battery Charge is below 50%'
              opdata: 'Battery charge is {ITEM.VALUE1} / 10000'
              priority: INFO
              manual_close: 'YES'
        - uuid: 91ff5c8032bd4589895de0596d34aa7b
          name: 'Battery Voltage'
          type: DEPENDENT
          key: batteryVoltage
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: V
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.batteries[0].voltage'
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Voltage'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
          triggers:
            - uuid: 6ab05257f12a4e3b901a348edeba5817
              expression: 'nodata(/SunMAX SolarPoint/batteryVoltage,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} has not reported data in more than {$UNIFI_ALERT_PERIOD}'
              priority: WARNING
        - uuid: 90941e741dfa4b7a847ce07a6560d6eb
          name: 'Battery charge daily rolling average'
          type: CALCULATED
          key: battery_charge_rolling_average
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          params: 'avg(//batteryCharge,1d)'
        - uuid: 3ece83b6e20a483bbd40f760d16d3e22
          name: 'Daily Average Net Power Consumption'
          type: CALCULATED
          key: daily_average_net_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//net_power_consumption,1d)'
          description: 'Change in charge for the battery for the last day'
        - uuid: 477eeccdfa60493da62aa422b923d8a8
          name: 'Raw Power Consumption Daily Average'
          type: CALCULATED
          key: daily_raw_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//raw_power_consumption,1d)'
          tags:
            - tag: Application
              value: Battery
        - uuid: 8c3ac7ccd317433ca8c67b3a81e5c42f
          name: 'Monthly Average Net Power Consumption'
          type: CALCULATED
          key: monthly_average_net_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//net_power_consumption,30d)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '-1000'
                - '1000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Power Consumption'
        - uuid: c0ea86e3665c4539b080a94d76d14396
          name: 'Raw Power Consumption Monthly Average'
          type: CALCULATED
          key: monthly_raw_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//raw_power_consumption,30d)'
          tags:
            - tag: Application
              value: Battery
        - uuid: bfda151539714084bd37e8d04c3f544c
          name: 'Net Power Consumption'
          type: CALCULATED
          key: net_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'last(//pvInputPower) - last(//powerOutput)- {$SOLARPOINT_CONSUMPTION}'
          description: 'Net instantaneous power consumption - assumes the SolarPoint device and inefficiencies of the system consumes 2.233W'
          tags:
            - tag: Application
              value: Battery
        - uuid: 2ddbf78585f147b7b6e2dc637d5f4e5e
          name: 'Power Output'
          type: DEPENDENT
          key: powerOutput
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: W
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.output.power'
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '1000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Power Consumption'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
        - uuid: 403d912eff154cd7870b795d4c98c1ab
          name: 'Power Input from Solar Array'
          type: DEPENDENT
          key: pvInputPower
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: W
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.pv.power'
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '1000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Power Input'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
        - uuid: 143059833e454233a6837519ffede9af
          name: 'Voltage from Solar Array'
          type: DEPENDENT
          key: pvInputVoltage
          delay: '0'
          history: 90d
          units: V
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.pv.voltage'
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Voltage'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
        - uuid: 3b0444475dd74c6fb5f32c39a0996adf
          name: 'Raw Power Consumption'
          type: CALCULATED
          key: raw_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'last(//pvInputPower) - last(//powerOutput)'
          description: 'Instantaneous power consumption: PV Input - power output.  Does not take the SolarPoint itself into account'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '-200'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Power'
          tags:
            - tag: Application
              value: Battery
        - uuid: ad7ea49d3203477b96ee03c5984b8870
          name: batteryJson
          type: EXTERNAL
          key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          tags:
            - tag: Application
              value: Battery
        - uuid: 1e16a0bf7ee34ce18fa42567d690c6d7
          name: 'Output Voltage'
          type: DEPENDENT
          key: voltageOutput
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: V
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.result[1].results.output.voltage'
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Voltage'
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          tags:
            - tag: Application
              value: Battery
        - uuid: e09c367e26ff493a9afa1e26a554a32e
          name: 'Weekly Average Power Consumption'
          type: CALCULATED
          key: weekly_average_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//net_power_consumption,7d)'
        - uuid: de6c4602b739426fafc8dcf5f2e85369
          name: 'Raw Power Consumption Weekly Average'
          type: CALCULATED
          key: weekly_raw_power_consumption
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: W
          params: 'avg(//raw_power_consumption,7d)'
          tags:
            - tag: Application
              value: Battery
      discovery_rules:
        - uuid: 64453202177f47eda7843e639609837d
          name: 'Power Port Discovery'
          type: DEPENDENT
          key: power_port_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 5ad15ebf54fc45b2a292c3d9e3ea6acd
              name: '{#PORT_NAME} Port Enabled'
              type: DEPENDENT
              key: 'port__enabled_[{#PORT_NAME}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.result[1].results.output.pins[ ?(@.name==''{#PORT_NAME}'') ].enabled.first()'
              master_item:
                key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
              tags:
                - tag: Application
                  value: Battery
            - uuid: 8f39f76a05ff47aa8e6c8ef55bcebff1
              name: '{#PORT_NAME} Port Low Voltage'
              type: DEPENDENT
              key: 'port__low_voltage_[{#PORT_NAME}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.result[1].results.output.pins[ ?(@.name==''{#PORT_NAME}'') ].low_voltage.first()'
              master_item:
                key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
              tags:
                - tag: Application
                  value: Battery
              trigger_prototypes:
                - uuid: 4528ebb39b1345889b79a2241b3945dd
                  expression: 'last(/SunMAX SolarPoint/port__low_voltage_[{#PORT_NAME}],#1)="true"'
                  name: '{#PORT_NAME} Port is in low voltage outage'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 6e35c0a2518944448151e35b58e9e930
              name: '{#PORT_NAME} Port On'
              type: DEPENDENT
              key: 'port__on_[{#PORT_NAME}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.result[1].results.output.pins[ ?(@.name==''{#PORT_NAME}'') ].on.first()'
              master_item:
                key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
              tags:
                - tag: Application
                  value: Battery
            - uuid: 2c30b45b07b04756a32e8ccfcf4bacc5
              name: '{#PORT_NAME} Port Suspended'
              type: DEPENDENT
              key: 'port__suspended_[{#PORT_NAME}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.result[1].results.output.pins[ ?(@.name==''{#PORT_NAME}'') ].suspended.first()'
              master_item:
                key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
              tags:
                - tag: Application
                  value: Battery
              trigger_prototypes:
                - uuid: 7bd866530508400d99031acd429303f9
                  expression: 'last(/SunMAX SolarPoint/port__suspended_[{#PORT_NAME}],#1)="true"'
                  name: '{#PORT_NAME} Port is Suspended'
                  priority: AVERAGE
          master_item:
            key: 'solarpointBattery.sh["-u", "{$SOLARPOINT_USERNAME}", "-p", "{$SOLARPOINT_PASSWORD}", {HOST.CONN}]'
          lld_macro_paths:
            - lld_macro: '{#PORT_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.result[1].results.output.pins'
      macros:
        - macro: '{$SOLARPOINT_CONSUMPTION}'
          value: '3.29'
          description: 'how much the device itself consumes'
    - uuid: 0a98ef31467349b58d955569f2efc963
      template: 'UBNT Airmax'
      name: 'UBNT Airmax'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 98f32cb2fb8449a89eb7cf0396995032
          name: airTime
          type: DEPENDENT
          key: airTime
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: REGEX
              parameters:
                - 'airTime=(.*)'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid AirTime Percentage'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
          triggers:
            - uuid: e4abdaf9196b4fae98d3de636ac86573
              expression: 'nodata(/UBNT Airmax/airTime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: WARNING
              manual_close: 'YES'
        - uuid: bb3c7aa6a2ad426e9eadd007eeff6452
          name: 'AirTime Smooth'
          type: CALCULATED
          key: airTimeSmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: 'avg(//airTime,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: a4cccd4157544aa8a81230333ad1449c
          name: CPU
          type: DEPENDENT
          key: cpuUsage
          delay: '0'
          history: 90d
          status: DISABLED
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'cpuUsage=(.*)'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Usage'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Host
        - uuid: ad7da803e4d94e2b81d1f77b0d2b9950
          name: loadavg
          type: DEPENDENT
          key: loadavg
          delay: '0'
          history: 90d
          status: DISABLED
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'loadavg=(.*)'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 2bc9a4f3da314707a94150cfe3963051
          name: noise
          type: DEPENDENT
          key: noise
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: db
          preprocessing:
            - type: REGEX
              parameters:
                - 'noise=(.*)'
                - \1
            - type: IN_RANGE
              parameters:
                - '-150'
                - '0'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Noise'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 8fd7fbcd72594be7ac5077369f233cdb
          name: 'Noise Smooth'
          type: CALCULATED
          key: noiseSmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: dB
          params: 'avg(//noise,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: f5f349c1a3e549bebff177381fedff9f
          name: signal
          type: DEPENDENT
          key: signal
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: db
          preprocessing:
            - type: REGEX
              parameters:
                - 'signal=(.*)'
                - \1
            - type: IN_RANGE
              parameters:
                - '-150'
                - '0'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Signal'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 2d04562fa0774125beef8043875a63ab
          name: 'Signal Smooth'
          type: CALCULATED
          key: signalSmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: dB
          params: 'avg(//signal,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: 5fee14bc3d6447fbb7a56c75fecfa907
          name: mca-status
          type: EXTERNAL
          key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
        - uuid: b0b1603f6ce447a0a77551d8ba293fe8
          name: wlanDownlinkCapacity
          type: DEPENDENT
          key: wlanDownlinkCapacity
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanDownlinkCapacity=(.*)'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1000'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 141c618d52af4523810a2053dfc2e07e
          name: 'WAN Downlink Capacity Smooth'
          type: CALCULATED
          key: wlanDownlinkCapacitySmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: bps
          params: 'avg(//wlanDownlinkCapacity,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: c878f4a3a9d14e4290f07c1b9fa1bd86
          name: wlanRxBandwidth
          type: DEPENDENT
          key: wlanRxBandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanRxBytes=(.*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Bandwidth'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 982b5677b12f49bdb0d5be89c4090fa2
          name: 'WAN Reception Bandwidth Smooth'
          type: CALCULATED
          key: wlanRxBandwidthSmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: bps
          params: 'avg(//wlanRxBandwidth,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: 35b3f48548f04173a347f5696ed67512
          name: wlanRxErrors
          type: DEPENDENT
          key: wlanRxErrors
          delay: '0'
          history: 90d
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanRxErrors=(.*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 52a83afd3e694a789073da60506066f7
          name: wlanTxBandwidth
          type: DEPENDENT
          key: wlanTxBandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanTxBytes=(.*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Bandwidth'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: eb50d36ade534adda015c481c883d6ea
          name: 'WAN Transmission Bandwidth Smooth'
          type: CALCULATED
          key: wlanTxBandwidthSmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: bps
          params: 'avg(//wlanTxBandwidth,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
        - uuid: 37cd1176cf2c46b39e37d3074f80140a
          name: wlanTxErrors
          type: DEPENDENT
          key: wlanTxErrors
          delay: '0'
          history: 90d
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanTxErrors=(.*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 1ee6f64675294e7abe57c8754a9392b3
          name: wlanUplinkCapacity
          type: DEPENDENT
          key: wlanUplinkCapacity
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - 'wlanUplinkCapacity=(.*)'
                - \1
            - type: MULTIPLIER
              parameters:
                - '1000'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Bandwidth'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","/bin/mca-status"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 82b243484217404e94c3ef38f5243af9
          name: 'WAN Uplink Capacity Smooth'
          type: CALCULATED
          key: wlanUplinkCapacitySmooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: bps
          params: 'avg(//wlanUplinkCapacity,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Radio
    - uuid: a7de22ea581d4acf9dfc99de63c10f9d
      template: 'Unifi AP'
      name: 'Unifi AP'
      description: |
        uses mca-dump via ssh to get AP info.
        
        Assign this template to all APs in your site
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Patrice
        - name: Unifi
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: e63c657c75794479a6ce8a5ef1c676e9
          name: 'Client Count'
          type: DEPENDENT
          key: client_count
          delay: '0'
          history: 90d
          units: clients
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.vap_table.[*].clientCount.sum()'
            - type: IN_RANGE
              parameters:
                - '0'
                - '2000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Client Count'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: c0502d070bf24f8481781eed09b02e36
          name: 'CPU Utilization'
          type: DEPENDENT
          key: cpu
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Percentage'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 3dcc138706314816bb2ddc17c564ac70
          name: Hostname
          type: DEPENDENT
          key: hostname
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: NAME
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.hostname
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: aa79c0aace6b4f8bbb7276dd7ccb8055
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          triggers:
            - uuid: 7a5a38bb6cbd477d9c5205eae71f5869
              expression: 'max(/Unifi AP/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Unifi AP/icmpping[],{$UNIFI_ALERT_PERIOD})>0'
              name: '{HOST.NAME} is not pingable'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 7c68c34cc8f64eba86c7ae2ef30efd7f
          name: 'Load Average 1mn'
          type: DEPENDENT
          key: load_avg_1mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.[''sys_stats''].loadavg_1'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: c534c56cf9e84b2ca63d52aa42691915
          name: 'Load Average 5mn'
          type: DEPENDENT
          key: load_avg_5mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.[''sys_stats''].loadavg_5'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 0201b2ca3b084aa08c6151fb01a31a1c
          name: 'Load Average 15mn'
          type: DEPENDENT
          key: load_avg_15mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.[''sys_stats''].loadavg_15'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: d5b6cf216295410d8702946b303d9579
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
        - uuid: f07faffa28cc416483cf089bb94ec20a
          name: 'Memory Utilization'
          type: CALCULATED
          key: memory
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: '100* last(//mem_used) / last(//mem_total)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Percentage'
          tags:
            - tag: Application
              value: Host
        - uuid: f49d35e7e8ec43299f27b8f4b24c042a
          name: 'Total Memory'
          type: DEPENDENT
          key: mem_total
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_total
            - type: IN_RANGE
              parameters:
                - '0'
                - '1000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Memory'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 67da102d9a6d4145bc7f7888d2c06e16
          name: 'Memory Used'
          type: DEPENDENT
          key: mem_used
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_used
            - type: IN_RANGE
              parameters:
                - '0'
                - '1000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Memory'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 3c2df9c3ad504a71b43cd3eeaceb4f9d
          name: Satisfaction
          type: DEPENDENT
          key: sat
          delay: '0'
          history: 90d
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.satisfaction
            - type: STR_REPLACE
              parameters:
                - '-1'
                - '100'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Percentage'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Radio
          triggers:
            - uuid: be561d7959ff4054a016af7adfd8b5c7
              expression: 'avg(/Unifi AP/sat,{$UNIFI_ALERT_PERIOD})<70'
              name: '{HOST.NAME} Satisfaction < 70 %'
              opdata: 'Satisfaction is {ITEM.VALUE1}'
              priority: INFO
              manual_close: 'YES'
        - uuid: 1485697ffb9a4544b1b1db86704eafa9
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 1d
          units: s
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: b8c15f7c71934ce89958890a93893a3b
              expression: 'nodata(/Unifi AP/uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: 'AP {HOST.NAME} is not reporting statistics'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} is not pingable'
                  expression: 'max(/Unifi AP/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
                  recovery_expression: 'min(/Unifi AP/icmpping[],{$UNIFI_ALERT_PERIOD})>0'
        - uuid: 26900b13cdb742259963690fb57cf251
          name: 'Wireless Reception Bandwidth'
          type: DEPENDENT
          key: wireless_reception_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.vap_table.[*].rx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Bandwitch'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Radio
        - uuid: 7653b935e51940438db00a20e7ede1e2
          name: 'Wireless Transmission Bandwidth'
          type: DEPENDENT
          key: wireless_transmission_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.vap_table.[*].tx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Bandwidth'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Radio
      discovery_rules:
        - uuid: 6e857bdd5a674e4e8be70b0e01d00d1a
          name: 'Active Radio Discovery'
          type: DEPENDENT
          key: active_radio_discovery
          delay: '0'
          lifetime: 1d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'List all active radios to create channel items'
          item_prototypes:
            - uuid: b2ad8503bd71430d93959a6aeb338ed3
              name: 'Channel Number {#RADIO_NAME}'
              type: DEPENDENT
              key: 'channel[{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.radio == ''{#RADIO_NAME}'')].channel.first()'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '1'
                    - '255'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Channel Value'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
              trigger_prototypes:
                - uuid: 35674d206a224a61b05c3f570c8c0095
                  expression: 'change(/Unifi AP/channel[{#RADIO_NAME}])<>0'
                  name: '{HOST.NAME}  {#RADIO_NAME} Channel Change'
                  priority: INFO
                  manual_close: 'YES'
            - uuid: f35732598f6f4aed84477b0932b496cb
              name: 'Channel Interference {#RADIO_NAME}'
              type: CALCULATED
              key: 'cint[{#RADIO_NAME}]'
              history: 90d
              units: '%'
              params: '((last( //cu_total[{#RADIO_NAME}] )- last( //cu_tx[{#RADIO_NAME}])-last(//cu_rx[{#RADIO_NAME}]))>0)*(last( //cu_total[{#RADIO_NAME}] )- last( //cu_tx[{#RADIO_NAME}])-last(//cu_rx[{#RADIO_NAME}]))'
              preprocessing:
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Value'
              tags:
                - tag: Application
                  value: Radio
              trigger_prototypes:
                - uuid: 3f72d760eb204eceafe82682fbda16a5
                  expression: 'avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}'
                  name: '{HOST.NAME}  {#RADIO_NAME} Channel Interference > {$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}%'
                  opdata: 'Interference is {ITEM.VALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                - uuid: e774c76335834241b15c4e203889e7e0
                  expression: 'avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:"{#RADIO_NAME}"}'
                  name: '{HOST.NAME}  {#RADIO_NAME} Channel Interference > {$UNIFI_CHANNEL_INTERFERENCE_INFO_THRESHOLD:"{#RADIO_NAME}"}%'
                  opdata: 'Interference is {ITEM.VALUE1}'
                  priority: INFO
                  manual_close: 'YES'
                  dependencies:
                    - name: '{HOST.NAME}  {#RADIO_NAME} Channel Interference > {$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}%'
                      expression: 'avg(/Unifi AP/cint[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_INTERFERENCE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}'
            - uuid: 60ae3f2aea144c1bb42780bc424d7184
              name: 'Channel Reception Utilization {#RADIO_NAME}'
              type: DEPENDENT
              key: 'cu_rx[{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: '%'
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.radio_table[?(@.radio == ''{#RADIO_NAME}'')].athstats.cu_self_rx.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
            - uuid: 466eee19400040749764a086133c4342
              name: 'Channel Total Utilization {#RADIO_NAME}'
              type: DEPENDENT
              key: 'cu_total[{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: '%'
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.radio_table[?(@.radio == ''{#RADIO_NAME}'')].athstats.cu_total.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Percentage Value'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
              trigger_prototypes:
                - uuid: 9047af0eb978454aab5768341986f29b
                  expression: 'avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}'
                  name: '{HOST.NAME}  {#RADIO_NAME} Channel Utilization > {$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}%'
                  opdata: 'Utilization is {ITEM.VALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                - uuid: 69372713ad284b79a905f5942c321b55
                  expression: 'avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:"{#RADIO_NAME}"}'
                  name: '{HOST.NAME}  {#RADIO_NAME} Channel Utilization > {$UNIFI_CHANNEL_USAGE_INFO_THRESHOLD:"{#RADIO_NAME}"}%'
                  opdata: 'Utilization is {ITEM.VALUE1}'
                  priority: INFO
                  manual_close: 'YES'
                  dependencies:
                    - name: '{HOST.NAME}  {#RADIO_NAME} Channel Utilization > {$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}%'
                      expression: 'avg(/Unifi AP/cu_total[{#RADIO_NAME}],{$UNIFI_ALERT_PERIOD})>{$UNIFI_CHANNEL_USAGE_AVERAGE_THRESHOLD:"{#RADIO_NAME}"}'
            - uuid: 11b74b119dea413ea1152b15a8e3eacb
              name: 'Channel Transmission Utilization {#RADIO_NAME}'
              type: DEPENDENT
              key: 'cu_tx[{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: '%'
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.radio_table[?(@.radio == ''{#RADIO_NAME}'')].athstats.cu_self_tx.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Percentage Value'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
            - uuid: 13bbc5518393491eb303198385799fbf
              name: 'Channel Retries {#RADIO_NAME}'
              type: DEPENDENT
              key: 'retries[{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.radio == ''{#RADIO_NAME}'')].tx_retries.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
          graph_prototypes:
            - uuid: 02ca3d6fb6cd4f9291070725a6b98cc3
              name: 'Utilization and Interference {#RADIO_NAME}'
              height: '400'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi AP'
                    key: 'cint[{#RADIO_NAME}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Unifi AP'
                    key: 'cu_total[{#RADIO_NAME}]'
                - sortorder: '3'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Unifi AP'
                    key: 'cu_tx[{#RADIO_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#RADIO_NAME}'
              path: $.radio
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.radio_table.[?(@.athstats.name != "" &&  (@.athstats.noise_floor < 0  && @.athstats.noise_floor > -500 || @.cu_total > 0))]'
              error_handler: DISCARD_VALUE
        - uuid: 90e43b647faa4a6fa7af643960bcf0a5
          name: 'Wifi Network Discovery'
          type: DEPENDENT
          key: wifi_network_discovery
          delay: '0'
          lifetime: 1d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Wifi Network Discovery Rule'
          item_prototypes:
            - uuid: 6596b148b2d14ce3aca993d8dc1acf5f
              name: '{#ESSID}-{#RADIO_NAME} Client Count'
              type: DEPENDENT
              key: 'client_count[{#ESSID}-{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: clients
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vap_table.[ ?(@.essid == "{#ESSID}"  && @.radio == "{#RADIO_NAME}") ].clientCount.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
            - uuid: 99af4e53516341b1b4e40d814fe7a258
              name: '{#ESSID}-{#RADIO_NAME} Rx Bandwidth'
              type: DEPENDENT
              key: 'rx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vap_table.[ ?(@.essid == "{#ESSID}"  && @.radio == "{#RADIO_NAME}") ].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
            - uuid: b18528ee504149118ecc6aac93c51135
              name: '{#ESSID}-{#RADIO_NAME} Tx Bandwidth'
              type: DEPENDENT
              key: 'tx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vap_table.[ ?(@.essid == "{#ESSID}"  && @.radio == "{#RADIO_NAME}") ].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Radio
          graph_prototypes:
            - uuid: 27c2c173f4d24b48b7341f0762c727a4
              name: '{#ESSID}-{#RADIO_NAME} Bandwidth and Clients'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi AP'
                    key: 'rx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi AP'
                    key: 'tx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
                - sortorder: '3'
                  color: '274482'
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'Unifi AP'
                    key: 'client_count[{#ESSID}-{#RADIO_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-P", "{$UNIFI_SSH_PORT}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#ESSID}'
              path: $.essid
            - lld_macro: '{#RADIO_NAME}'
              path: $.radio
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.vap_table
      macros:
        - macro: '{$UNIFI_LOAD_AVERAGE_HIGH}'
          value: '4'
        - macro: '{$UNIFI_LOAD_AVERAGE_MEDIUM}'
          value: '3'
    - uuid: 7d97fa717ee745cc8acc35152dfc93de
      template: 'Unifi Protect Camera'
      name: 'Unifi Protect Camera'
      description: 'Assign this to all the protect cameras to track availability and OS versions'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Unifi
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 844186fe9f6a45fab4b6d7e328a7a27a
          name: 'Camera Name'
          type: DEPENDENT
          key: camera_name
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            - type: REGEX
              parameters:
                - '^Linux (\S*)'
                - \1
          master_item:
            key: 'ssh.run[uname]'
        - uuid: c5c93a248fa14b7aa37d35db3a0c9fe8
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 1d
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: c92b0647b8284e2fa9bf10a16821b431
              expression: 'time() > {$OPERATING_HOURS_START} and time() < {$OPERATING_HOURS_END} and  max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              name: 'Camera {HOST.NAME} is not pingable'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Application
                  value: Protect
        - uuid: 15a568e6472548a99053c4a8ca9ed924
          name: 'MAC Address'
          type: DEPENDENT
          key: Mac
          delay: '0'
          history: 1d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - '.*HWaddr ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})'
                - \1
          master_item:
            key: 'ssh.run[ifconfig]'
        - uuid: 2cef0436644d43b89057c680ee659c3f
          name: 'Reception Bandwidth'
          type: DEPENDENT
          key: rx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - '.*RX bytes:(\d*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '10000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Reception Bandwidth'
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
        - uuid: 0081678ffe614bcd97836a30fd545d87
          name: ifconfig
          type: SSH
          key: 'ssh.run[ifconfig]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 1d
          trends: '0'
          value_type: TEXT
          params: 'if ifconfig eth0 >/dev/null 2>&1 ; then ifconfig eth0; else ifconfig wlan0; fi'
          username: ubnt
          password: '{$PROTECT_CAMERA_PASSWORD}'
          tags:
            - tag: Application
              value: Network
          triggers:
            - uuid: 2117be829d9e4e34a1307d14cd387cc0
              expression: 'time() > {$OPERATING_HOURS_START} and time() < {$OPERATING_HOURS_END} and  nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_PERIOD})=1'
              name: 'Camera {HOST.NAME} SSH is not available'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: 'Camera {HOST.NAME} is not pingable'
                  expression: 'time() > {$OPERATING_HOURS_START} and time() < {$OPERATING_HOURS_END} and  max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              tags:
                - tag: Application
                  value: Protect
        - uuid: accb9d8274d84bb8857c7d67eb934f21
          name: uname
          type: SSH
          key: 'ssh.run[uname]'
          delay: 1h
          history: 90d
          trends: '0'
          value_type: CHAR
          params: 'uname -a'
          username: ubnt
          password: '{$PROTECT_CAMERA_PASSWORD}'
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Availability
        - uuid: 31105775931e445ca087eb65b0fcd3b1
          name: 'Transmission Bandwidth'
          type: DEPENDENT
          key: tx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: REGEX
              parameters:
                - '.*TX bytes:(\d*)'
                - \1
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100000000'
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
          triggers:
            - uuid: ae881c785d1d4f7d9daf1ce86f0336ac
              expression: 'avg(/Unifi Protect Camera/tx_bandwidth,10m)<{$PROTECT_LOW_BANDWIDTH}'
              name: 'Camera {HOST.NAME} Outgoing Bandwidth Low'
              opdata: 'Outgoing Bandwidth is {ITEM.VALUE1}'
              priority: WARNING
              dependencies:
                - name: 'Camera {HOST.NAME} is not pingable'
                  expression: 'time() > {$OPERATING_HOURS_START} and time() < {$OPERATING_HOURS_END} and  max(/Unifi Protect Camera/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
                - name: 'Camera {HOST.NAME} SSH is not available'
                  expression: 'time() > {$OPERATING_HOURS_START} and time() < {$OPERATING_HOURS_END} and  nodata(/Unifi Protect Camera/ssh.run[ifconfig],{$UNIFI_ALERT_PERIOD})=1'
              tags:
                - tag: Application
                  value: Protect
      macros:
        - macro: '{$OPERATING_HOURS_END}'
          value: '235959'
          description: 'When the camera stops operating if on a schedule'
        - macro: '{$OPERATING_HOURS_START}'
          value: '0'
          description: 'When the camera starts operating if on a schedule'
    - uuid: cb5f1c2aac8d4779b50187acf329d2a3
      template: 'Unifi Protect Cloud Key'
      name: 'Unifi Protect Cloud Key'
      description: 'Assign this template to your Cloud Keys running Protect'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 4a94f51e12d747e1a363143c615c6baa
          name: 'Incoming Bandwidth Moving Average Threshold'
          type: CALCULATED
          key: incoming_bandwidth_moving_average_threshold
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          units: bps
          params: |
            (
            avg(//IpExtInOctets,1h:now-1d)+
            avg(//IpExtInOctets,1h:now-2d)+
            avg(//IpExtInOctets,1h:now-3d)+
            avg(//IpExtInOctets,1h:now-4d)+
            avg(//IpExtInOctets,1h:now-5d)+
            avg(//IpExtInOctets,1h:now-6d)+
            avg(//IpExtInOctets,1h:now-7d)
            ) /7*.7
          tags:
            - tag: Application
              value: Bandwidth
        - uuid: 4f71cb1ac9534508b8b391414ee8345e
          name: 'Incoming Bandwidth'
          type: DEPENDENT
          key: IpExtInOctets
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.kernel.IpExtInOctets
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'ssh.run[nstat]'
          tags:
            - tag: Application
              value: Network
          triggers:
            - uuid: 7f2a2c7fdad34f378b385eb53e9e08c3
              expression: 'avg(/Unifi Protect Cloud Key/IpExtInOctets,3600s) < 10000'
              name: '{HOST.NAME} Incoming Bandwidth Problem'
              opdata: 'Incoming Bandwidth is {ITEM.VALUE1}'
              priority: AVERAGE
              manual_close: 'YES'
              dependencies:
                - name: 'Unifi Protect is not running on {HOST.NAME}'
                  expression: 'min(/Unifi Protect Cloud Key/ssh.run[protect],{$UNIFI_ALERT_PERIOD})>0'
            - uuid: 1e88147fdc28426f9b8d227993f6045e
              expression: 'nodata(/Unifi Protect Cloud Key/IpExtInOctets,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} SSH is not available'
                  expression: 'nodata(/Unifi SSH Host/load_avg_1mn_uptime,{$UNIFI_ALERT_PERIOD})=1'
        - uuid: 017f3db264db4c1c801661a46f465e46
          name: nstat
          type: SSH
          key: 'ssh.run[nstat]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          params: 'nstat -j -a'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Network
        - uuid: e74e3b2e99fb4f58a58076bbf59bbc51
          name: 'Unifi-Protect Service Status'
          type: SSH
          key: 'ssh.run[protect]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          params: 'service unifi-protect status >/dev/null; echo $?'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          triggers:
            - uuid: 7d52e86e0fbf4eb4a5149f4bf20a0a9b
              expression: 'min(/Unifi Protect Cloud Key/ssh.run[protect],{$UNIFI_ALERT_PERIOD})>0'
              name: 'Unifi Protect is not running on {HOST.NAME}'
              priority: AVERAGE
        - uuid: e1d2e198baa2468fae4e354627b99bcd
          name: 'Web Entry Point'
          type: HTTP_AGENT
          key: web_app
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          trends: '0'
          value_type: TEXT
          timeout: 3s
          url: 'https://{HOST.CONN}'
          retrieve_mode: HEADERS
          triggers:
            - uuid: 7aa3a5e7e07244be87bd122c49a916f6
              expression: 'find(/Unifi Protect Cloud Key/web_app,{$UNIFI_ALERT_PERIOD},"like","200")=0'
              name: 'Unifi Protect Web App is not running on {HOST.NAME}'
              priority: AVERAGE
    - uuid: 5c308fb434614ef8acf2f94a04963cf4
      template: 'Unifi Protect NVR4'
      name: 'Unifi Protect NVR4'
      description: 'Assign this template to your UNVR4s running Protect'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 4d686eb0368b42ce8e90e854977e856c
          name: 'CPU Idle'
          type: DEPENDENT
          key: cpu_idle
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysstat.hosts[0].statistics[0].cpuload[0].idle'
          master_item:
            key: 'ssh.run[mpstat_nvr]'
          tags:
            - tag: Application
              value: Host
        - uuid: c55a4afc0d3f41f08ed439730558edf0
          name: 'CPU smooth'
          type: CALCULATED
          key: cpu_smooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: 'avg(//cpu_utilization,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Host
        - uuid: d5b94cccc9994d39b37aef02bbc0550a
          name: 'CPU Utlization'
          type: CALCULATED
          key: cpu_utilization
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: '100 - last(//cpu_idle)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Percentage'
          tags:
            - tag: Application
              value: Host
        - uuid: 9dcabffea95b4dd48e59fba2e3a2cbff
          name: 'Incoming Bandwidth Moving Average Threshold'
          type: CALCULATED
          key: incoming_bandwidth_moving_average_threshold
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: bps
          params: |
            (
            avg(//IpExtInOctets,1h:now-1d)+
            avg(//IpExtInOctets,1h:now-2d)+
            avg(//IpExtInOctets,1h:now-3d)+
            avg(//IpExtInOctets,1h:now-4d)+
            avg(//IpExtInOctets,1h:now-5d)+
            avg(//IpExtInOctets,1h:now-6d)+
            avg(//IpExtInOctets,1h:now-7d)
            ) /7*.7
          tags:
            - tag: Application
              value: Bandwidth
        - uuid: 5e773ded65124c77aaadbdc429ef69aa
          name: 'Incoming Bandwidth'
          type: DEPENDENT
          key: IpExtInOctets
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.kernel.IpExtInOctets
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'ssh.run[nstat]'
          tags:
            - tag: Application
              value: Network
          triggers:
            - uuid: 3d4f53db083b401386c1d6e5983f7b54
              expression: 'avg(/Unifi Protect NVR4/IpExtInOctets,1h) < 10000'
              name: '{HOST.NAME} Incoming Bandwidth Problem'
              opdata: 'Incoming Bandwidth is {ITEM.VALUE1}'
              priority: AVERAGE
              manual_close: 'YES'
              dependencies:
                - name: 'Unifi Protect is not running on {HOST.NAME}'
                  expression: 'min(/Unifi Protect NVR4/ssh.run[protect],{$UNIFI_ALERT_PERIOD})>0'
            - uuid: e4308a68f1df4a8e9ff7b3692a51355e
              expression: 'nodata(/Unifi Protect NVR4/IpExtInOctets,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} is not pingable'
                  expression: 'max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
                - name: '{HOST.NAME} SSH is not available'
                  expression: 'nodata(/Unifi SSH High Priority Host/load_avg_1mn_uptime,{$UNIFI_ALERT_PERIOD})=1'
        - uuid: e466492496544c28a4216331a5613846
          name: nodename
          type: DEPENDENT
          key: nodename
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysstat.hosts[0].nodename'
          master_item:
            key: 'ssh.run[mpstat_nvr]'
          tags:
            - tag: Application
              value: Host
        - uuid: b85e01f40dc94e4da492ee6f9d5ca00c
          name: mpstat
          type: SSH
          key: 'ssh.run[mpstat_nvr]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 2d
          trends: '0'
          value_type: CHAR
          params: 'mpstat -o JSON 1 1 | sed ''s/"cpu-load"/"cpuload"/'''
          authtype: PUBLIC_KEY
          username: root
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Host
        - uuid: 705b4fec2f7247fc9a9919a1669376ac
          name: nstat
          type: SSH
          key: 'ssh.run[nstat]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 2d
          trends: '0'
          value_type: TEXT
          params: 'nstat -j -a'
          authtype: PUBLIC_KEY
          username: root
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Network
        - uuid: 33970b555e2f43adb919b8f0ba543b06
          name: 'Protect Service Status'
          type: SSH
          key: 'ssh.run[protect]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          params: 'service unifi-protect status >/dev/null; echo $?'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          triggers:
            - uuid: 4618f80f013744cc91733bf5a15bb46a
              expression: 'min(/Unifi Protect NVR4/ssh.run[protect],{$UNIFI_ALERT_PERIOD})>0'
              name: 'Unifi Protect is not running on {HOST.NAME}'
              opdata: 'Status: last(/Unifi Protect Cloud Key/ssh.run[protect],#1)'
              priority: AVERAGE
        - uuid: cc50528fc52543a0972b0a325733a22e
          name: 'Temp 1'
          type: SSH
          key: 'ssh.run[temp1]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: C
          params: 'cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp1_input'
          authtype: PUBLIC_KEY
          username: root
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Temperature'
          tags:
            - tag: Application
              value: Host
        - uuid: 88dd5b446d504a84809b2372067e4a40
          name: 'Temp 2'
          type: SSH
          key: 'ssh.run[temp2]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: C
          params: 'cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp2_input'
          authtype: PUBLIC_KEY
          username: root
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Temperature'
          tags:
            - tag: Application
              value: Host
        - uuid: a0fb6f12fa4c443a8ba281155825bc38
          name: 'Temp 3'
          type: SSH
          key: 'ssh.run[temp3]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: C
          params: 'cat /sys/bus/i2c/drivers/adt7475/4-002e/hwmon/hwmon0/device/temp3_input'
          authtype: PUBLIC_KEY
          username: root
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.001'
            - type: IN_RANGE
              parameters:
                - '0'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Temperature'
          tags:
            - tag: Application
              value: Host
        - uuid: 24cac6e713d04af5ac4be614c6829c15
          name: 'Web Entry Point'
          type: HTTP_AGENT
          key: web_app
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          trends: '0'
          value_type: TEXT
          timeout: 3s
          url: 'https://{HOST.CONN}'
          retrieve_mode: HEADERS
          triggers:
            - uuid: 0f0a28c883bc43daaa955e6e57d7ee19
              expression: 'find(/Unifi Protect NVR4/web_app,{$UNIFI_ALERT_PERIOD},"like","200")=0'
              name: 'Protect Web App is not running on {HOST.NAME}'
              priority: AVERAGE
    - uuid: 3272996cc8f5409e8e7485d8dc2ba806
      template: 'Unifi RSA Only SSH Host'
      name: 'Unifi RSA Only SSH Host'
      description: 'Link this template to SSH hosts that only supports RSA.  Airmax devices are in that category currently'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: feab3f0568884c0baf0d6376dcf42eeb
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: 80310f375449403aacb0db3cac2dd664
              expression: 'max(/Unifi RSA Only SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              name: '{HOST.NAME} is not pingable'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 11e24a4547b24bfeac1ca7c0b903279e
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","uptime"]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
          triggers:
            - uuid: ecca6015d40548bf8848d9f92051a830
              expression: 'nodata(/Unifi RSA Only SSH Host/load_avg_1mn_uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} SSH is not available'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} is not pingable'
                  expression: 'max(/Unifi RSA Only SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
        - uuid: f2c9faa4ece64235be3b86c3c5f575a6
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","uptime"]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: bc12e1b52da94c2286c448731332747b
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","uptime"]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: 790c1329f3414960b5d41480b1a542df
          name: 'MAC Address A'
          type: DEPENDENT
          key: mac_a
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          description: 'MAC address of the interface tied to the host''s IP.  The IP address must be specified in the host connection in Zabbix (even if the DNS name is used to connect)'
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - '.*(HWaddr|ether) ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})'
                - \2
              error_handler: DISCARD_VALUE
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","ifconfig"]'
          tags:
            - tag: Application
              value: Network
        - uuid: b5a384c546094fcc9fd762cac2a72b84
          name: 'MAC Address B'
          type: DEPENDENT
          key: mac_b
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: REGEX
              parameters:
                - '(HWaddr|ether)(.|\n)*(HWaddr|ether) ([a-fA-F0-9:]{17})'
                - \4
              error_handler: CUSTOM_VALUE
              error_handler_params: N/A
          master_item:
            key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","ifconfig"]'
          tags:
            - tag: Application
              value: Network
        - uuid: 8f5895c4208645b2bf789f3c00a22a96
          name: ifconfig
          type: EXTERNAL
          key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","ifconfig"]'
          delay: 1h
          history: 2h
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
            - type: MATCHES_REGEX
              parameters:
                - '..*'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Could not find main interface.  maybe {HOST.IP} is not set'
          tags:
            - tag: Application
              value: Network
        - uuid: 7d2b785a24ff4615998d2fd2583b5706
          name: uname
          type: EXTERNAL
          key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","name"]'
          delay: 1h
          history: 90d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Host Unreachable'
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*ssh: command not found.*'
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: edae8229ce524f15b075861a7e52c4f2
              expression: 'change(/Unifi RSA Only SSH Host/ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","name"])=1'
              name: '{HOST.NAME} Version Change'
              opdata: 'New Version is {ITEM.VALUE1}'
              priority: INFO
              manual_close: 'YES'
        - uuid: 468d66af47ba4fd49f78e97eeb8941c9
          name: 'Number of processors'
          type: EXTERNAL
          key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","proc"]'
          delay: 1d
          history: 90d
          units: Processors
          description: 'Number of processors'
          preprocessing:
            - type: REGEX
              parameters:
                - '[0-9]'
                - \0
              error_handler: CUSTOM_VALUE
              error_handler_params: '1'
            - type: IN_RANGE
              parameters:
                - '0'
                - '32'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Number of Processors'
          tags:
            - tag: Application
              value: Hardware
            - tag: Application
              value: Host
        - uuid: 108f5de9a5a1474089ff047840907552
          name: 'ssh uptime'
          type: EXTERNAL
          key: 'ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","uptime"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 2d
          trends: '0'
          value_type: CHAR
          tags:
            - tag: Application
              value: Availability
            - tag: Application
              value: Performance
    - uuid: 0dbc328172e34d8c8b7f3cdfd554d08d
      template: 'Unifi SSH High Priority Host'
      name: 'Unifi SSH High Priority Host'
      description: 'Link this template to NVRs and Gateways'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: fa8381770b744e4b9a717ceef7c569aa
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          history: 90d
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: d392f22278464ef1bd4936d174f5b0cd
              expression: 'max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              name: '{HOST.NAME} is not pingable'
              priority: AVERAGE
              manual_close: 'YES'
        - uuid: 18d5b7b413a74fdeb09d1be567c80399
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
          triggers:
            - uuid: 08593d21fb5441518507f2470a0acf5e
              expression: 'nodata(/Unifi SSH High Priority Host/load_avg_1mn_uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} SSH is not available'
              priority: AVERAGE
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} is not pingable'
                  expression: 'max(/Unifi SSH High Priority Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
        - uuid: aa7dcd5b4f1a4331a603b3780f31be20
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: c6d1b2905b3f4d29ae9729f32e775368
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: cbfdeca6e1f8455db6bafe59b8693168
          name: 'MAC Address A'
          type: DEPENDENT
          key: mac_a
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - '.*HWaddr|ether ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})'
                - \1
              error_handler: DISCARD_VALUE
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
        - uuid: d7220ba9c416462fb768ecc14cd75253
          name: 'MAC Address B'
          type: DEPENDENT
          key: mac_b
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: REGEX
              parameters:
                - '(HWaddr|ether)(.|\n)*(HWaddr|ether) ([a-fA-F0-9:]{17})'
                - \4
              error_handler: CUSTOM_VALUE
              error_handler_params: N/A
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
        - uuid: 23e04f2d4e9c4e09925eb8a65f0f41dc
          name: ifconfig
          type: SSH
          key: 'ssh.run[ifconfig]'
          delay: 1h
          history: '0'
          trends: '0'
          value_type: CHAR
          params: '/sbin/ifconfig | grep -A5 {HOST.IP}'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Network
        - uuid: bffe19ef0bca4cb296bf55c9ef69a612
          name: 'Number of processors'
          type: SSH
          key: 'ssh.run[nproc]'
          delay: 1d
          history: 90d
          units: Processors
          params: nproc
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          description: 'Number of processors'
          preprocessing:
            - type: REGEX
              parameters:
                - '[0-9]'
                - \0
              error_handler: CUSTOM_VALUE
              error_handler_params: '1'
            - type: IN_RANGE
              parameters:
                - '0'
                - '32'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Number of Processors'
          tags:
            - tag: Application
              value: Hardware
            - tag: Application
              value: Host
        - uuid: 2371bcddb5e64826a68de1ffd034bc1f
          name: uname
          type: SSH
          key: 'ssh.run[uname]'
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          params: 'uname -a'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          description: 'uname -a'
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Host Unreachable'
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*ssh: command not found.*'
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: 61e39b8d10334b2eb0673169b3f54510
              expression: 'change(/Unifi SSH High Priority Host/ssh.run[uname])=1'
              name: '{HOST.NAME} Version Change'
              opdata: 'New Version is {ITEM.VALUE1}'
              priority: INFO
              manual_close: 'YES'
        - uuid: 73f78f9e0e3041f0a258cd41122fe3af
          name: uptime
          type: SSH
          key: 'ssh.run[uptime]'
          history: 2d
          trends: '0'
          value_type: CHAR
          params: uptime
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          description: uptime
          tags:
            - tag: Application
              value: Availability
            - tag: Application
              value: Performance
    - uuid: f87a92acbcb54704a4d23aad9a19ab36
      template: 'Unifi SSH Host'
      name: 'Unifi SSH Host'
      description: |
        Link this template to Unifi APs, Switches, USGes, UDMPs, Airmax devices hosts to get availability and version tracking on top of their specific template.
        
        This will work with any SSH host with basic UNIX on the other side really.
        
        Additionally,. this will fill the OS version and the MAC address in the inventory section.
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: d0b8592d9c5d4f55a2531ba748ad8ef2
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: 08a60db01cd24b47bb1802c30c71359c
              expression: 'max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              name: '{HOST.NAME} is not pingable'
              priority: WARNING
              manual_close: 'YES'
        - uuid: fa6026d048bb4efaba7e8b1caa187e82
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
          triggers:
            - uuid: 301ff9308c3e4c2f9938a92226b443a5
              expression: 'nodata(/Unifi SSH Host/load_avg_1mn_uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} SSH is not available'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} is not pingable'
                  expression: 'max(/Unifi SSH Host/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
        - uuid: 763b62c5ec40413d97b4e9c127e65f61
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: 1ead0560b5504179b4fededb31e952fa
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn_uptime
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: REGEX
              parameters:
                - '.*load average: [^ ]*, [^ ]*, ([0-9]+([.][0-9]+))'
                - \1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Load Average'
          master_item:
            key: 'ssh.run[uptime]'
          tags:
            - tag: Application
              value: Host
            - tag: Application
              value: Performance
        - uuid: 18f26cfa53744cbcba3f49581e546436
          name: 'MAC Address A'
          type: DEPENDENT
          key: mac_a
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          description: 'MAC address of the interface tied to the host''s IP.  The IP address must be specified in the host connection in Zabbix (even if the DNS name is used to connect)'
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - '.*(HWaddr|ether) ([a-fA-F0-9:]{17}|[a-fA-F0-9]{12})'
                - \2
              error_handler: DISCARD_VALUE
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
        - uuid: fb644aff10e7452586bc61429b3bb355
          name: 'MAC Address B'
          type: DEPENDENT
          key: mac_b
          delay: '0'
          history: 90d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: REGEX
              parameters:
                - '(HWaddr|ether)(.|\n)*(HWaddr|ether) ([a-fA-F0-9:]{17})'
                - \4
              error_handler: CUSTOM_VALUE
              error_handler_params: N/A
          master_item:
            key: 'ssh.run[ifconfig]'
          tags:
            - tag: Application
              value: Network
        - uuid: 2877b47ec7514bb392b4a4ba99c5af18
          name: ifconfig
          type: SSH
          key: 'ssh.run[ifconfig]'
          delay: 1h
          history: 2h
          trends: '0'
          value_type: CHAR
          params: '/sbin/ifconfig | grep -B1 -A5 {HOST.IP}'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
            - type: MATCHES_REGEX
              parameters:
                - '..*'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Could not find main interface.  maybe {HOST.IP} is not set'
          tags:
            - tag: Application
              value: Network
        - uuid: ae2f6914da0f4ea7be6de28638e521c9
          name: 'Number of processors'
          type: SSH
          key: 'ssh.run[nproc]'
          delay: 1d
          history: 90d
          units: Processors
          params: nproc
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          description: 'Number of processors'
          preprocessing:
            - type: REGEX
              parameters:
                - '[0-9]'
                - \0
              error_handler: CUSTOM_VALUE
              error_handler_params: '1'
            - type: IN_RANGE
              parameters:
                - '0'
                - '32'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Number of Processors'
          tags:
            - tag: Application
              value: Hardware
            - tag: Application
              value: Host
        - uuid: d1c0a1d2e0504e4391d297566e2e8465
          name: uname
          type: SSH
          key: 'ssh.run[uname]'
          delay: 1h
          history: 90d
          trends: '0'
          value_type: CHAR
          params: 'uname -a'
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          preprocessing:
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*No route to host.*'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Host Unreachable'
            - type: NOT_MATCHES_REGEX
              parameters:
                - '.*ssh: command not found.*'
          tags:
            - tag: Application
              value: Availability
          triggers:
            - uuid: 5558237e8dab41a0b5070c3dcf8120a3
              expression: 'change(/Unifi SSH Host/ssh.run[uname])=1'
              name: '{HOST.NAME} Version Change'
              opdata: 'New Version is {ITEM.VALUE1}'
              priority: INFO
              manual_close: 'YES'
        - uuid: 0cdc86cae6b742e4bf08e06e10d4da1b
          name: 'ssh uptime'
          type: SSH
          key: 'ssh.run[uptime]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 2d
          trends: '0'
          value_type: CHAR
          params: uptime
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Availability
            - tag: Application
              value: Performance
    - uuid: 9b6c0fb011ee43549cb49302b36642d8
      template: 'Unifi Switch'
      name: 'Unifi Switch'
      description: 'Link this template to all Unifi switches'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Patrice
        - name: Unifi
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: ba86097608d94aec9f9bd74f965310d7
          name: 'CPU Utilization'
          type: DEPENDENT
          key: cpu
          delay: '0'
          history: 90d
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
            - type: JAVASCRIPT
              parameters:
                - 'return Math.round(value)'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 5ab9f788137f4ab9a8b38127d52fe141
          name: 'CPU Smooth'
          type: CALCULATED
          key: cpu_smooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: 'avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Host
        - uuid: c2b45cc0a0ad4079879229108e2ef1a6
          name: ping
          type: SIMPLE
          key: 'icmpping[]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          triggers:
            - uuid: a82ac34472b547428f7084e2fb00fd86
              expression: 'max(/Unifi Switch/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Unifi Switch/icmpping[],{$UNIFI_ALERT_PERIOD})>0'
              name: 'Switch {HOST.NAME} is not pingable'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 4047c5bb508b454ea435ed14736b573b
          name: 'Load Average 1mn'
          type: DEPENDENT
          key: load_avg_1mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: 9e29ac5c713c471ba6da69eb45c01732
          name: 'Load Average 5mn'
          type: DEPENDENT
          key: load_avg_5mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: fd6213ada9c3468f9d64e540a8c95159
          name: 'Load Average 15mn'
          type: DEPENDENT
          key: load_avg_15mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: 3aab4c5928fe428eaa68c3ded3c966d8
          name: 'mac address'
          type: DEPENDENT
          key: mac_address
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.mac
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: c4668b5e15954379bbe9515188d96624
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Host
        - uuid: b7a28c7b13a94f8f9317ba6466c1d4f0
          name: mca-dump-switch-discovery
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_DISCOVERY_FREQUENCY}'
          history: '0'
          trends: '0'
          status: DISABLED
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
          tags:
            - tag: Application
              value: Power
        - uuid: 3dbc59ea31d54d20b49a1b8aacbd31b0
          name: mca-dump-feature-discovery
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_FEATURE_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_DISCOVERY_FREQUENCY}'
          history: '0'
          trends: '0'
          status: DISABLED
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
          tags:
            - tag: Application
              value: Power
        - uuid: ac98ab08a67a4bcba69e026763025344
          name: 'Memory Utilization'
          type: CALCULATED
          key: memory
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          units: '%'
          params: '100* last(//mem_used) / last(//mem_total)'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return Math.round(value)'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Memory Utilization'
          tags:
            - tag: Application
              value: Host
        - uuid: f767db4353aa4a24b373bcbd6a804ec1
          name: 'Total Memory'
          type: DEPENDENT
          key: mem_total
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_total
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 6a239d18bcac4189a95a6631dc1dbfe3
          name: 'Memory Used'
          type: DEPENDENT
          key: mem_used
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_used
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 8be7925af1e84e088375e798ea0a0261
          name: Model
          type: DEPENDENT
          key: model
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.model_display
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: d42df9b654fc4a2c88ed8e70106dca82
          name: 'Total Rx Bandwidth'
          type: DEPENDENT
          key: total_rx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[*].rx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: e89dd99080734254b3da3423f1b4549c
          name: 'Total Tx Bandwidth'
          type: DEPENDENT
          key: total_tx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[*].tx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: 48e7a8ec7bad4aa69a883adbf6564009
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 90d
          units: s
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: 61975534a4404efa8df675da2609c5f2
              expression: 'nodata(/Unifi Switch/uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: 'Switch {HOST.NAME} is not reporting statistics'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: 'Switch {HOST.NAME} is not pingable'
                  expression: 'max(/Unifi Switch/icmpping[],{$UNIFI_ALERT_PERIOD})=0'
                  recovery_expression: 'min(/Unifi Switch/icmpping[],{$UNIFI_ALERT_PERIOD})>0'
      discovery_rules:
        - uuid: c63e03a538104cdebad4f428337e2952
          name: 'Fan Discovery'
          type: DEPENDENT
          key: fan_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: b84302d8102645eb882c4cec6131dddc
              name: 'Fan Level'
              type: DEPENDENT
              key: '_[{#FAN_LEVEL_KEY_NAME}]'
              delay: '0'
              history: 90d
              units: '%'
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - $.fan_level
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
          graph_prototypes:
            - uuid: d1e7161d8eb141b293eacfe4f5305c09
              name: 'Fan Level'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi Switch'
                    key: '_[{#FAN_LEVEL_KEY_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_FEATURE_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#FAN_LEVEL_KEY_NAME}'
              path: $.fan_level_key_name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$[?(@.has_fan=="true")]'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Fanless Switch'
        - uuid: 3440ec98490a4b40bcc1dddca0955cb8
          name: 'POE Discovery'
          type: DEPENDENT
          key: poe_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 2ae16684b40b44adb53ae3363094beef
              name: 'Max Power'
              type: DEPENDENT
              key: '_[{#MAX_POWER_KEY_NAME}]'
              delay: '0'
              history: 90d
              units: W
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - $.total_max_power
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '1000'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Power'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
            - uuid: a8f107c6ff074de28b110c188b139f79
              name: 'Percent Power Consumed'
              type: CALCULATED
              key: '_[{#PERCENT_POWER_CONSUMED_KEY_NAME}]'
              history: 90d
              params: '100 * last(//_[{#TOTAL_POWER_CONSUMED_KEY_NAME}]) / last(//_[{#MAX_POWER_KEY_NAME}])'
              preprocessing:
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Percentage'
              tags:
                - tag: Application
                  value: Power
            - uuid: 318b0db443194b53afe55ccbda40bd4c
              name: 'Total Power Consumed'
              type: DEPENDENT
              key: '_[{#TOTAL_POWER_CONSUMED_KEY_NAME}]'
              delay: '0'
              history: 90d
              value_type: FLOAT
              units: W
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[*].poe_power.sum()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '1000'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Invalid Power'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_FEATURE_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#MAX_POWER_KEY_NAME}'
              path: $.max_power_key_name
            - lld_macro: '{#PERCENT_POWER_CONSUMED_KEY_NAME}'
              path: $.percent_power_consumed_key_name
            - lld_macro: '{#TOTAL_POWER_CONSUMED_KEY_NAME}'
              path: $.total_power_consumed_key_name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$[?(@.power=="true")]'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'No POE on this switch'
        - uuid: ccacdb7fcb1c41d1a3e58f7a201e6603
          name: 'POE Discovery by Port'
          type: DEPENDENT
          key: poe_discovery_by_port
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 1793fb114e2d4fa3b40820d8c51e1d51
              name: 'Power Consumed Port {#PORT_IDX}'
              type: DEPENDENT
              key: 'power_consumed_port[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              value_type: FLOAT
              units: W
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table.[ ?(@.port_idx==''{#PORT_IDX}'') ].poe_power.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
          graph_prototypes:
            - uuid: e919a515e0b14d94aa0f3424f790c5a2
              name: 'Power Consumed by Port {#PORT_IDX}'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi Switch'
                    key: 'power_consumed_port[{#PORT_IDX}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#PORT_IDX}'
              path: $.port_idx
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[?(@.poe_power>=0)]'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'No POE ports on this switch'
        - uuid: 2363ae0485a84853af24157aab6ed5f5
          name: 'Switch Port Discovery'
          type: DEPENDENT
          key: switch_port_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 2a70d96ce61f4e7facfd66e0acbad45e
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} Connection Speed'
              type: DEPENDENT
              key: 'connection_speed_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].speed.first()'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 23118e1970b442b5a3b5f5645e48b6ad
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} Uplink'
              type: DEPENDENT
              key: 'is_uplink_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].is_uplink.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 05486e2ab46b41dca2e917db1211e680
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} Rx Bandwidth'
              type: DEPENDENT
              key: 'rx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: a3e991eb253e4b6487dcef2fc1f11ca3
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} STP State'
              type: DEPENDENT
              key: 'stp_state_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].stp_state.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 6aa38f9c842746d0a77edb81dbf7d955
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} Tx Bandwidth'
              type: DEPENDENT
              key: 'tx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: e39e30dea20544a8948f05f20155df79
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} {#PORT_DESC} Up'
              type: DEPENDENT
              key: 'up_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].up.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          trigger_prototypes:
            - uuid: 2bb9f140e9254b83b86f5318fd3a5240
              expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}/100 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}/100 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above {$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}%'
              opdata: 'Port Usage is rx:{ITEM.VALUE4} tx:{ITEM.VALUE5}'
              priority: AVERAGE
            - uuid: ce61140da14e4a1ea919f2e083ee6835
              expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_INFO_THRESHOLD}/100 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_INFO_THRESHOLD}/100 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above {$UNIFI_PORT_USAGE_INFO_THRESHOLD}%'
              opdata: 'Port Usage is rx:{ITEM.VALUE4} tx:{ITEM.VALUE5}'
              priority: INFO
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above {$UNIFI_PORT_USAGE_WARNING_THRESHOLD}%'
                  expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and (  avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_WARNING_THRESHOLD}/100 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_WARNING_THRESHOLD}/100 )'
            - uuid: 054404edaf6b444a9c293b68a48a9adf
              expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and (  avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_WARNING_THRESHOLD}/100 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_WARNING_THRESHOLD}/100 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above {$UNIFI_PORT_USAGE_WARNING_THRESHOLD}%'
              opdata: 'Port Usage is rx:{ITEM.VALUE4} tx:{ITEM.VALUE5}'
              priority: WARNING
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above {$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}%'
                  expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and ( avg(/Unifi Switch/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}/100 or avg(/Unifi Switch/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)*{$UNIFI_PORT_USAGE_AVERAGE_THRESHOLD}/100 )'
            - uuid: eaf603c09ea74aa19692349a662034de
              expression: 'last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#2)>0 and last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi Switch/up_[{#PORT_IDX}],#1)="true" and last(/Unifi Switch/stp_state_[{#PORT_IDX}],#1)="forwarding" and (last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#1) <> last(/Unifi Switch/connection_speed_[{#PORT_IDX}],#2))'
              recovery_mode: NONE
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} has changed Connection Speed'
              opdata: 'Port Usage is rx:{ITEM.VALUE4} tx:{ITEM.VALUE5}'
              priority: INFO
              description: 'Might indicate bad wiring, or just a new device with a different interface being connected'
              manual_close: 'YES'
          graph_prototypes:
            - uuid: 573a52f59a844f798b12c86c12a7acd4
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Port I/O'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi Switch'
                    key: 'rx_port_[{#PORT_IDX}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi Switch'
                    key: 'tx_port_[{#PORT_IDX}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#LOCAL_PORT_NAME}'
              path: $.local_port_name
            - lld_macro: '{#PORT_DESC}'
              path: $.port_desc
            - lld_macro: '{#PORT_IDX}'
              path: $.port_idx
            - lld_macro: '{#PORT_IS_UPLINK}'
              path: $.is_uplink
            - lld_macro: '{#PORT_MEDIA}'
              path: $.media
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.port_table
              error_handler: DISCARD_VALUE
        - uuid: a520f7c4997947a4865af775a70e1ac7
          name: 'Temperature Discovery'
          type: DEPENDENT
          key: temperature_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: bb33a8f4a3ad4b44b1171de47669577e
              name: Overheating
              type: DEPENDENT
              key: '_[{#OVERHEATING_KEY_NAME}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - $.overheating
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
            - uuid: 1ee44c1518f441bd9ad5d3c585049926
              name: Temperature
              type: DEPENDENT
              key: '_[{#TEMPERATURE_KEY_NAME}]'
              delay: '0'
              history: 90d
              value_type: FLOAT
              units: C
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - $.general_temperature
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-U", "{$UNIFI_VERBOSE_SSH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Power
          graph_prototypes:
            - uuid: b6431556a31941d29b7b592c57342e4d
              name: 'Temperature [{#TEMPERATURE_KEY_NAME}]'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi Switch'
                    key: '_[{#TEMPERATURE_KEY_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "SWITCH_FEATURE_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#OVERHEATING_KEY_NAME}'
              path: $.overheating_key_name
            - lld_macro: '{#TEMPERATURE_KEY_NAME}'
              path: $.temperature_key_name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$[?(@.has_temperature=="true")]'
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
      macros:
        - macro: '{$UNIFI_LOAD_AVERAGE_HIGH}'
          value: '5'
        - macro: '{$UNIFI_LOAD_AVERAGE_MEDIUM}'
          value: '4'
    - uuid: 8838e1f9216740ef85fc1dcd9aa40470
      template: 'Unifi UDMP'
      name: 'Unifi UDMP'
      description: 'Link this template to UDMPs'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 18f6381b1c3648b297fbcd37afd8c4b6
          name: 'CPU Utilization'
          type: DEPENDENT
          key: cpu
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: bfac9fee93424eebbe3a3a3925f56ebc
              expression: 'avg(/Unifi UDMP/cpu,10m)>{$UNIFI_CPU_UTILIZATION_HIGH}'
              name: '{HOST.NAME} CPU Utilization is > {$UNIFI_CPU_UTILIZATION_HIGH}%'
              opdata: 'CPU utilization is {ITEM.VALUE1}'
              priority: AVERAGE
              manual_close: 'YES'
        - uuid: 9204754ee4064cdb86e7363d0712bbd3
          name: 'CPU Smooth'
          type: CALCULATED
          key: cpu_smooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: 'avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Host
        - uuid: 8e27edf5a301436ba32463a2fd615e44
          name: 'Fan Speed'
          type: DEPENDENT
          key: fanSpeed
          delay: '0'
          history: 90d
          units: rpm
          preprocessing:
            - type: REGEX
              parameters:
                - 'fan1:[ ]+([0-9]+) RPM'
                - \1
          master_item:
            key: 'ssh.run[sensors]'
        - uuid: e205941cf309403cb90a79a2c77c79db
          name: Hostname
          type: DEPENDENT
          key: hostname
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - $.hostname
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 6636015b71184c2a9eb3d74a696fd9ac
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: bc785bbc152b420a931451829442b3a6
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: c10b01b0305646729a64414799837881
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          triggers:
            - uuid: 8ba158c318ec4aee9d1351de353b6d9d
              expression: 'last(/Unifi UDMP/load_avg_15mn,#1)>{$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
              name: '{HOST.NAME} load average is > {$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
              opdata: 'Load Average is {ITEM.VALUE1}'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 8eb698db79b94fa18684ebcee01876b7
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: '$. mcaDumpValidationError.reason'
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Host
        - uuid: fbdf870bf43f40fbb6fc65ffcc806a7e
          name: 'mca-dump fan discovery'
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP_FAN_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_DISCOVERY_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
          tags:
            - tag: Application
              value: Host
        - uuid: edc477cd12ed4a09b0229145ab0dac8b
          name: 'Memory Utilization'
          type: CALCULATED
          key: memory
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: '100* last(//mem_used) / last(//mem_total)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Percentage'
          tags:
            - tag: Application
              value: Host
        - uuid: 6d11b4ee4bfd4e46876003b76ab98f8b
          name: 'Total Memory'
          type: DEPENDENT
          key: mem_total
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_total
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: fc15813aadcf4ab0a7fce520edead1d0
          name: 'Memory Used'
          type: DEPENDENT
          key: mem_used
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_used
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: ce371d643fa241f08754f455091c7f12
          name: Model
          type: DEPENDENT
          key: model
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.model_display
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 46eb9ca1f2c64ae09304bd11f695589f
          name: sensors
          type: SSH
          key: 'ssh.run[sensors]'
          delay: '{$UNIFI_DISCOVERY_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          params: sensors
          authtype: PUBLIC_KEY
          username: '{$UNIFI_USER}'
          publickey: '{$UNIFI_PUB_KEY}'
          privatekey: '{$UNIFI_PRIV_KEY}'
          tags:
            - tag: Application
              value: Host
        - uuid: ff07a3572bfa4f089c7abf60cdc45163
          name: 'Total Switch Rx Bandwidth'
          type: DEPENDENT
          key: total_switch_rx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          description: 'Total Bandwidth Received by the 8 port switch embedded in the UDMP (ports 1-8)'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[?(@.port_idx < 9)].rx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: 1ef97d3bf6b84e179d80ffe44c00bb40
          name: 'Total Switch Tx Bandwidth'
          type: DEPENDENT
          key: total_switch_tx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          description: 'Total Bandwidth Sent by the 8 port switch embedded in the UDMP (ports 1-8)'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[?(@.port_idx < 9)].tx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: ba7054579a914ad4aa25941fc192c3aa
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 90d
          units: s
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: b592d4299ef9482496c585caa936112c
              expression: 'nodata(/Unifi UDMP/uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: HIGH
              manual_close: 'YES'
      discovery_rules:
        - uuid: 587bc229309143898a4bb0cc6209b269
          name: 'External Interface Discovery'
          type: DEPENDENT
          key: external_interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Interface Discovery'
          item_prototypes:
            - uuid: 32017ea908ad4006b87e751f79c83a9f
              name: '{#INTERFACE_NAME} Latency'
              type: DEPENDENT
              key: 'latency[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: ms
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].latency.first()'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '10000'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Incorrect Latency'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" && @.latency > 0 )]'
        - uuid: 164715828328451f85ebcd3965b42cdd
          name: 'Fan discovery'
          type: DEPENDENT
          key: fan_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 50a2c089141f4e9cb7a596bb6a54b0c5
              name: '{#FAN_NAME} Speed'
              type: DEPENDENT
              key: 'speed_[{#FAN_NAME}]'
              delay: '0'
              history: 90d
              units: rpm
              preprocessing:
                - type: REGEX
                  parameters:
                    - '{#FAN_NAME}:[ ]+([0-9]+) RPM'
                    - \1
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '10000'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Incorrect Fan Speed'
              master_item:
                key: 'ssh.run[sensors]'
          graph_prototypes:
            - uuid: fde460352bd44381b9a13d0c4c144d63
              name: '{#FAN_NAME} Speed'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi UDMP'
                    key: 'speed_[{#FAN_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP_FAN_DISCOVERY", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#FAN_NAME}'
              path: $.name
        - uuid: 7b20ff6b9502498b9c37efe32b10ce9a
          name: 'Interface Discovery'
          type: DEPENDENT
          key: interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Interface Discovery'
          item_prototypes:
            - uuid: a83194a6f5a240fc8a130abb7489d9ef
              name: '{#INTERFACE_NAME} Dropped Reception Packets'
              type: DEPENDENT
              key: 'dropped_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: ef026690172b46eaaae587331a66136e
              name: '{#INTERFACE_NAME} Dropped Transmission Packets'
              type: DEPENDENT
              key: 'dropped_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: a0bff0f5cb4e4d56b810d2ea9d7d5be1
              name: '{#INTERFACE_NAME} Error Reception Packets'
              type: DEPENDENT
              key: 'error_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: da5cfac36bc44556bdd78d0c83b2745e
              name: '{#INTERFACE_NAME} Error Transmission Packets'
              type: DEPENDENT
              key: 'error_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 50a88a6badc740b48367d56752d7fb2b
              name: '{#INTERFACE_NAME} Reception Bandwidth'
              type: DEPENDENT
              key: 'rx_bandwitdh[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 59b810a80e6e401fa9618d3ea5f4ae87
              name: '{#INTERFACE_NAME} Transmission Bandwidth'
              type: DEPENDENT
              key: 'tx_bandwitdh[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" )]'
        - uuid: 85739b2b715a4246a543ebfdaa9aeb73
          name: 'Network Discovery'
          type: DEPENDENT
          key: network_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Network Discovery'
          item_prototypes:
            - uuid: 3120f764520c4881af4d5f84116dacb1
              name: '{#NETWORK_NAME} VLAN Reception Bandwidth'
              type: DEPENDENT
              key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: cf0082a5d087409d8bf36cf4f9b954ae
              name: '{#NETWORK_NAME} VLAN Transmission Bandwidth'
              type: DEPENDENT
              key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          graph_prototypes:
            - uuid: 7a62b41d75314aea883418cf203a38d9
              name: '{#NETWORK_NAME} Inter-VLAN Bandwidth'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi UDMP'
                    key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi UDMP'
                    key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#NETWORK_ADDRESS}'
              path: $.address
            - lld_macro: '{#NETWORK_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.network_table[?(@.active_dhcp_lease_count>0 && @.address != "" && @.name != "" )]'
        - uuid: 58568f925c7c4f7bb44800d431141b69
          name: 'Site to Site VPN Discovery'
          type: DEPENDENT
          key: site_to_site_vpn_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: c797de40215b4b99a2e6fec77cbf6d6e
              name: 'Remote Site Rx Bandwidth - {#REMOTE_SITE_IP}'
              type: DEPENDENT
              key: 'remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vpn[*].remotes[?(@.ip  == ''{#REMOTE_SITE_IP}'')].rxRate.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 699f174819c64cf79820addab60c3a67
              name: 'Remote Site Tx Bandwidth - {#REMOTE_SITE_IP}'
              type: DEPENDENT
              key: 'remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vpn[*].remotes[?(@.ip  == ''{#REMOTE_SITE_IP}'')].txRate.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          graph_prototypes:
            - uuid: 25bf1af2bd6b4629bd724b6251d197c1
              name: 'Remote Site Bandwidth - {#REMOTE_SITE_IP}'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi UDMP'
                    key: 'remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi UDMP'
                    key: 'remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#REMOTE_SITE_IP}'
              path: $.ip
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.vpn[?(@.id =~ "site-to-site")].remotes[0]'
        - uuid: c4593426190a422dbdf3341a066c4214
          name: 'Switch Port Discovery'
          type: DEPENDENT
          key: switch_port_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 679a3e2856dd46c6a966843c44738a5b
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Connection Speed'
              type: DEPENDENT
              key: 'connection_speed_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].speed.first()'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 1b52fd26f9654509a911f6a43d8658ab
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Uplink'
              type: DEPENDENT
              key: 'is_uplink_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].is_uplink.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 0d02ff3c40e94f4b9c0495fafc3f9a1c
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Rx Bandwidth'
              type: DEPENDENT
              key: 'rx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100000000000'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 78a554f976144a7ea4db83051148a91b
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Tx Bandwidth'
              type: DEPENDENT
              key: 'tx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100000000000'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: c42462fcfe1e47b4abc2ca083d18d458
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Up'
              type: DEPENDENT
              key: 'up_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].up.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          trigger_prototypes:
            - uuid: 6e678d3587d944b8bb4a87b7a5ef5935
              expression: 'last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.25 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.25 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 25%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: INFO
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 50%'
                  expression: 'last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)="true" and (  avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 )'
            - uuid: 14c2ce7629714ff38b1ed1fcaae6ebd3
              expression: 'last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)="true" and (  avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.5 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 50%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: WARNING
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 75%'
                  expression: 'last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 )'
            - uuid: 37beea9d4c814e8f8818ddc65c207e3c
              expression: 'last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi UDMP/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi UDMP/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi UDMP/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi UDMP/connection_speed_[{#PORT_IDX}],#1)*.75 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 75%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: AVERAGE
          graph_prototypes:
            - uuid: 877968bc3fbb4d2daf2421e3e4b31569
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Port I/O'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi UDMP'
                    key: 'rx_port_[{#PORT_IDX}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi UDMP'
                    key: 'tx_port_[{#PORT_IDX}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#LOCAL_PORT_NAME}'
              path: $.local_port_name
            - lld_macro: '{#PORT_IDX}'
              path: $.port_idx
            - lld_macro: '{#PORT_IS_UPLINK}'
              path: $.is_uplink
            - lld_macro: '{#PORT_MEDIA}'
              path: $.media
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.port_table
        - uuid: 79730c11924e4704a5ea06941e9aa709
          name: 'Temp Discovery'
          type: DEPENDENT
          key: temperature_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Temperature Discovery'
          item_prototypes:
            - uuid: 2c9624083cec496d82c13258022d1664
              name: 'Temperature {#TEMP_NAME} ({#TEMP_TYPE})'
              type: DEPENDENT
              key: 'temp_[{#TEMP_NAME}]'
              delay: '0'
              history: 90d
              value_type: FLOAT
              units: C
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.temperatures[ ?(@.name == ''{#TEMP_NAME}'' ) ].value.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Incorrect Temperature'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              trigger_prototypes:
                - uuid: 91bbbbb25fc946ffb538f394085bfe7d
                  expression: 'last(/Unifi UDMP/temp_[{#TEMP_NAME}],#1)>{$UNIFI_ALERT_TEMP}'
                  name: 'High Temperature for {#TEMP_NAME}'
                  event_name: 'high_temperature_{#TEMP_NAME}'
                  opdata: 'Temperature is {ITEM.VALUE1}C'
                  priority: WARNING
          graph_prototypes:
            - uuid: 26aca30dcaf8406d969b4bb7acc9803d
              name: 'Temperature [{#TEMP_NAME}]'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi UDMP'
                    key: 'temp_[{#TEMP_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "UDMP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#TEMP_NAME}'
              path: $.name
            - lld_macro: '{#TEMP_TYPE}'
              path: $.type
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.temperatures
      macros:
        - macro: '{$UNIFI_CPU_UTILIZATION_HIGH}'
          value: '75'
        - macro: '{$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
          value: '8'
        - macro: '{$UNIFI_USER}'
          value: root
          description: 'AP Zabbix SSH Username - UDMP only supports root'
    - uuid: f15020131b5c4b7b96100df9faedce9c
      template: 'Unifi USG'
      name: 'Unifi USG'
      description: 'Link this template to USGs'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 81d276921081468c895ca7c7d9b3e918
          name: 'CPU Utilization'
          type: DEPENDENT
          key: cpu
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Invalid Percentage'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: a5aeed02d2de40468e2b803199236775
          name: Hostname
          type: DEPENDENT
          key: hostname
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: NAME
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.hostname
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 2af7394fc1514af3a0993250e3b93f7d
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: 8675bf85b33d4e6fbc801a2d08e5c42e
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: 1cf125481eaa4efc9a5fa47fcdb5e107
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          triggers:
            - uuid: a1ada827db7a4b4cb827072f9cb82436
              expression: 'last(/Unifi USG/load_avg_15mn,#1)>{$UNIFI_LOAD_AVERAGE_HIGH}'
              name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH}'
              opdata: 'Load Average is {ITEM.VALUE1}'
              priority: AVERAGE
              manual_close: 'YES'
            - uuid: 34e34199443f41fea3ba92deea88c5d0
              expression: 'last(/Unifi USG/load_avg_15mn,#1)>{$UNIFI_LOAD_AVERAGE_MEDIUM}'
              name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_MEDIUM}'
              opdata: 'Load Average is {ITEM.VALUE1}'
              priority: WARNING
              manual_close: 'YES'
              dependencies:
                - name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH}'
                  expression: 'last(/Unifi USG/load_avg_15mn,#1)>{$UNIFI_LOAD_AVERAGE_HIGH}'
        - uuid: 4503d713fb44413ea199a63178ad08e2
          name: mca-dump-discovery
          type: EXTERNAL
          key: 'mca-dump-short.sh[ "-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_DISCOVERY_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
          tags:
            - tag: Application
              value: Host
        - uuid: 01ee1019a6924fb68849a55218890a6f
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Host
        - uuid: b563bf45785f4115aebbe863be59d5b3
          name: 'Memory Utilization'
          type: CALCULATED
          key: memory
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: '100* last(//mem_used) / last(//mem_total)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          tags:
            - tag: Application
              value: Host
        - uuid: ea425dc7ad9441e4a98d3dda70d686f0
          name: 'Total Memory'
          type: DEPENDENT
          key: mem_total
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_total
            - type: IN_RANGE
              parameters:
                - '100000000'
                - '1000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Memory Size'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 85a3e058622143858b1d03f42e8502ea
          name: 'Memory Used'
          type: DEPENDENT
          key: mem_used
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_used
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 7b26ad9b743a40a19158e509e8d805a9
          name: Model
          type: DEPENDENT
          key: model
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: mcaDumpError
            - type: JSONPATH
              parameters:
                - $.model_display
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 8599d352cdda477c80879089f13354d7
          name: 'Temperature CPU'
          type: DEPENDENT
          key: temperature.cpu
          delay: '0'
          history: 90d
          units: C
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpWarning.missingTemperatures
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.["system-stats"].temps.CPU'
            - type: STR_REPLACE
              parameters:
                - ' C'
                - ''
            - type: IN_RANGE
              parameters:
                - '0'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Temperature'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 8aff108a17754957b7af5385e653fd46
          name: 'Temperature PHY'
          type: DEPENDENT
          key: temperature.phy
          delay: '0'
          history: 90d
          units: C
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpWarning.missingTemperatures
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.["system-stats"].temps.PHY'
            - type: STR_REPLACE
              parameters:
                - ' C'
                - ''
            - type: IN_RANGE
              parameters:
                - '0'
                - '200'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Temperature'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 4a8bde0252204cbe912780251a386e7e
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 90d
          units: s
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: 4da4bf931fc3455a9c92a4ff2153518f
              expression: 'nodata(/Unifi USG/uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: HIGH
              manual_close: 'YES'
      discovery_rules:
        - uuid: c0b0d0a60191441d8608aa3d5fcc2f0e
          name: 'External Interface Discovery'
          type: DEPENDENT
          key: external_interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 4b67b2b83e414272876118307e0ee8c1
              name: '{#INTERFACE_NAME} Latency'
              type: DEPENDENT
              key: 'latency[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: ms
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].latency.first()'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh[ "-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.reason
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" && @.latency > 0 )]'
        - uuid: 30628a74a4d047108b731201709dd0cf
          name: 'Interface Discovery'
          type: DEPENDENT
          key: interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: a3a9a919765b42d38f402c9de8d6dcf6
              name: '{#INTERFACE_NAME} Dropped Reception Packets'
              type: DEPENDENT
              key: 'dropped_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 776bba813b5a4074baced462d8790202
              name: '{#INTERFACE_NAME} Dropped Transmission Packets'
              type: DEPENDENT
              key: 'dropped_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 9501596fbba44b218ebe472b2a933d6a
              name: '{#INTERFACE_NAME} Error Reception Packets'
              type: DEPENDENT
              key: 'error_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 844b49f61d244b24b5b7e4ed855d6e41
              name: '{#INTERFACE_NAME} Error Transmission Packets'
              type: DEPENDENT
              key: 'error_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 83c70fed5040461da15332098aee2749
              name: '{#INTERFACE_NAME} Reception Bandwidth'
              type: DEPENDENT
              key: 'reception_bandwidth[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 23faff035f8d4b348b20861b3d2b41f7
              name: '{#INTERFACE_NAME} Transmission Bandwidth'
              type: DEPENDENT
              key: 'transmission_bandwidth[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh[ "-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.reason
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" )]'
        - uuid: feb50bd260ce4553a47bb89eeb5e46e8
          name: 'Network Discovery'
          type: DEPENDENT
          key: network_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 2e6f9468a3464faa9f2407d046fa723f
              name: '{#NETWORK_NAME} VLAN Reception Bandwidth'
              type: DEPENDENT
              key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}-{#NETWORK_ADDRESS}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 1521ead6676944f881eb0ec1abe3d5ee
              name: '{#NETWORK_NAME} VLAN Transmission Bandwidth'
              type: DEPENDENT
              key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}-{#NETWORK_ADDRESS}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}","-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          graph_prototypes:
            - uuid: 85d0ab43c9024020818f5678c63ac6bf
              name: '{#NETWORK_NAME}-{#NETWORK_ADDRESS} Inter-VLAN Bandwidth'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi USG'
                    key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}-{#NETWORK_ADDRESS}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi USG'
                    key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}-{#NETWORK_ADDRESS}]'
          master_item:
            key: 'mca-dump-short.sh[ "-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#NETWORK_ADDRESS}'
              path: $.address
            - lld_macro: '{#NETWORK_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.reason
            - type: JSONPATH
              parameters:
                - '$.network_table[ ?(@.up == "true" && @.address != "" && @.name != "" && @.name != "vti64" && "@.host_table.length()" > 0)]'
    - uuid: f499c9c160d540769242513bc328a82c
      template: 'Unifi USG Lite'
      name: 'Unifi USG Lite'
      description: 'Link this template to USG Lites'
      templates:
        - name: 'Unsupported Item'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: d12af11dd40c4f5f917edf2605421954
          name: 'CPU Utilization'
          type: DEPENDENT
          key: cpu
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Utilization'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: 12b9ae4b6f4f4c1ca5eab89328ab4a35
              expression: 'avg(/Unifi USG Lite/cpu,15m)>{$UNIFI_CPU_UTILIZATION_HIGH}'
              name: '{HOST.NAME} CPU Utilization is > {$UNIFI_CPU_UTILIZATION_HIGH}%'
              opdata: 'CPU utilization is {ITEM.VALUE1}'
              priority: AVERAGE
              manual_close: 'YES'
        - uuid: 1ec511653ef245cbbf61ea1879b826f5
          name: 'CPU Smooth'
          type: CALCULATED
          key: cpu_smooth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: 'avg(//cpu,{$UNIFI_SMOOTHING_PERIOD})'
          tags:
            - tag: Application
              value: Host
        - uuid: 4e7a41d4f7204cba9d06c753b91be7cc
          name: Hostname
          type: DEPENDENT
          key: hostname
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - $.hostname
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: fffc8a9be6e949beacf016d67eeeb2cf
          name: 'Load Average (1mn)'
          type: DEPENDENT
          key: load_avg_1mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: a2647e39043e40c682dd1e18443aae5a
          name: 'Load Average (5mn)'
          type: DEPENDENT
          key: load_avg_5mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
        - uuid: a1089326de3748debaae259ace999f19
          name: 'Load Average (15mn)'
          type: DEPENDENT
          key: load_avg_15mn
          delay: '0'
          history: 90d
          value_type: FLOAT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Load Average'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          triggers:
            - uuid: 48aebdd864ce4fe89353b5b525807589
              expression: 'last(/Unifi USG Lite/load_avg_15mn,#1)>{$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
              name: '{HOST.NAME} load average is > {$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
              opdata: 'Load Average is {ITEM.VALUE1}'
              priority: WARNING
              manual_close: 'YES'
        - uuid: 976bc3baf8544b3d949f2173bf592104
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: '$. mcaDumpValidationError.reason'
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Host
        - uuid: 2f6a0b620fe14b2a83bfccd17216f6a1
          name: 'Memory Utilization'
          type: CALCULATED
          key: memory
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          value_type: FLOAT
          units: '%'
          params: '100* last(//mem_used) / last(//mem_total)'
          preprocessing:
            - type: IN_RANGE
              parameters:
                - '0'
                - '100'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Percentage'
          tags:
            - tag: Application
              value: Host
        - uuid: d8b1dc20eb6b45acb1c650198ca46f9a
          name: 'Total Memory'
          type: DEPENDENT
          key: mem_total
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_total
            - type: IN_RANGE
              parameters:
                - '100000000'
                - '2000000000'
              error_handler: CUSTOM_ERROR
              error_handler_params: 'Incorrect Memory Size'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 1dc24e06237b4e1c8875916bf30f1ad1
          name: 'Memory Used'
          type: DEPENDENT
          key: mem_used
          delay: '0'
          history: 90d
          units: bytes
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.mem_used
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 8362a36624b94d3abe905ff0893d1d2d
          name: Model
          type: DEPENDENT
          key: model
          delay: '0'
          history: 90d
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.model_display
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
        - uuid: 079258585eea4b069dafb402cd8f6965
          name: 'Total Switch Rx Bandwidth'
          type: DEPENDENT
          key: total_switch_rx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          description: 'Total Bandwidth Received by the 8 port switch embedded in the UDMP (ports 1-8)'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[?(@.port_idx < 9)].rx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: a7ead770b8544ab59c5c665438475bf5
          name: 'Total Switch Tx Bandwidth'
          type: DEPENDENT
          key: total_switch_tx_bandwidth
          delay: '0'
          history: 90d
          units: bps
          description: 'Total Bandwidth Sent by the 8 port switch embedded in the UDMP (ports 1-8)'
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
            - type: JSONPATH
              parameters:
                - '$.port_table[?(@.port_idx < 9)].tx_bytes.sum()'
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Traffic
        - uuid: 2458ec5c56444dc58044e700c9afba95
          name: Uptime
          type: DEPENDENT
          key: uptime
          delay: '0'
          history: 90d
          units: s
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.uptime
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          tags:
            - tag: Application
              value: Host
          triggers:
            - uuid: f85e36404f75429d853b9836a42ca12c
              expression: 'nodata(/Unifi USG Lite/uptime,{$UNIFI_ALERT_PERIOD})=1'
              name: '{HOST.NAME} is not reporting statistics'
              priority: HIGH
              manual_close: 'YES'
      discovery_rules:
        - uuid: a1894f91d9f94dd796d7acc08048c3a9
          name: 'External Interface Discovery'
          type: DEPENDENT
          key: external_interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Interface Discovery'
          item_prototypes:
            - uuid: 49809b82d87c4b359789852ecbaa4220
              name: '{#INTERFACE_NAME} Latency'
              type: DEPENDENT
              key: 'latency[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: ms
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].latency.first()'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '1000'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Incorrect Latency'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" && @.latency > 0 )]'
        - uuid: b98cc5129a034f7dba81542f9b1d3691
          name: 'Interface Discovery'
          type: DEPENDENT
          key: interface_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Interface Discovery'
          item_prototypes:
            - uuid: 8a8d528aa18a462cb60333b30598aea8
              name: '{#INTERFACE_NAME} Dropped Reception Packets'
              type: DEPENDENT
              key: 'dropped_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: c84f53a57f8d491b988d702c5a849ce4
              name: '{#INTERFACE_NAME} Dropped Transmission Packets'
              type: DEPENDENT
              key: 'dropped_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_dropped.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 15b2206c8cc841c3834e7c61f0710f57
              name: '{#INTERFACE_NAME} Error Reception Packets'
              type: DEPENDENT
              key: 'error_rx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: a68582b9fe254a3eb0ec31360bbbaa4b
              name: '{#INTERFACE_NAME} Error Transmission Packets'
              type: DEPENDENT
              key: 'error_tx_packets[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: pkts
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_errors.first()'
                - type: SIMPLE_CHANGE
                  parameters:
                    - ''
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: cff3924d751a4262b637f6b2e1a0f1f0
              name: '{#INTERFACE_NAME} Reception Bandwidth'
              type: DEPENDENT
              key: 'rx_bandwitdh[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
            - uuid: 102c8b9e3c3f428eb86ebfb30d8e01e8
              name: '{#INTERFACE_NAME} Transmission Bandwidth'
              type: DEPENDENT
              key: 'tx_bandwitdh[{#INTERFACE_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.if_table[ ?(@.name == ''{#INTERFACE_NAME}'' ) ].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#INTERFACE_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.if_table[?(@.up == "true" && @.name != "" )]'
        - uuid: f8b0e22aacc84d0089a165d6e6a89b4e
          name: 'Network Discovery'
          type: DEPENDENT
          key: network_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Network Discovery'
          item_prototypes:
            - uuid: 4f30b9f07e704c4fb24a05ecc1ee9d63
              name: '{#NETWORK_NAME} VLAN Reception Bandwidth'
              type: DEPENDENT
              key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 81b8fb45d86d42dea4b632c2cd76933d
              name: '{#NETWORK_NAME} VLAN Transmission Bandwidth'
              type: DEPENDENT
              key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.network_table[ ?(@.address == ''{#NETWORK_ADDRESS}'' ) ].stats.tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          graph_prototypes:
            - uuid: d4c822b54d9d4b8aba884c8f9cffaba5
              name: '{#NETWORK_NAME} Inter-VLAN Bandwidth'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi USG Lite'
                    key: 'vlan_rx_bandwitdh[{#NETWORK_NAME}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi USG Lite'
                    key: 'vlan_tx_bandwitdh[{#NETWORK_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#NETWORK_ADDRESS}'
              path: $.address
            - lld_macro: '{#NETWORK_NAME}'
              path: $.name
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.network_table[?(@.active_dhcp_lease_count>0 && @.address != "" && @.name != "" )]'
        - uuid: 55372e79ee874cf5a9d0fe23b99731b6
          name: 'Site to Site VPN Discovery'
          type: DEPENDENT
          key: site_to_site_vpn_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 7351b50f8c9d4001b334b767b994a7cb
              name: 'Remote Site Rx Bandwidth - {#REMOTE_SITE_IP}'
              type: DEPENDENT
              key: 'remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vpn[*].remotes[?(@.ip  == ''{#REMOTE_SITE_IP}'')].rxRate.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: c69642f26b744f2aac67abd8f5f4dafe
              name: 'Remote Site Tx Bandwidth - {#REMOTE_SITE_IP}'
              type: DEPENDENT
              key: 'remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.vpn[*].remotes[?(@.ip  == ''{#REMOTE_SITE_IP}'')].txRate.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          graph_prototypes:
            - uuid: bd5e89b5230d49bdaa0530df278278ec
              name: 'Remote Site Bandwidth - {#REMOTE_SITE_IP}'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi USG Lite'
                    key: 'remote_site_rx_bandwitdh[{#REMOTE_SITE_IP}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi USG Lite'
                    key: 'remote_site_tx_bandwitdh[{#REMOTE_SITE_IP}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#REMOTE_SITE_IP}'
              path: $.ip
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - '$.vpn[?(@.id =~ "site-to-site")].remotes[0]'
        - uuid: 15cff3fe1cd64d958f8c24862ce87e20
          name: 'Switch Port Discovery'
          type: DEPENDENT
          key: switch_port_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 9e177c4f85284f7994871670ce0d5de5
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Connection Speed'
              type: DEPENDENT
              key: 'connection_speed_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].speed.first()'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 3102bc529ee74c7f9b478163266150bd
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Uplink'
              type: DEPENDENT
              key: 'is_uplink_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].is_uplink.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 9c615c42e4d24e0e9b03aafdf03cdc05
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Rx Bandwidth'
              type: DEPENDENT
              key: 'rx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100000000000'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 22b9f5d881bb45f49d4c64be907b0421
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Tx Bandwidth'
              type: DEPENDENT
              key: 'tx_port_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              units: bps
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100000000000'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
            - uuid: 358470e9fcdc4dc687618b988efb7ea8
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Up'
              type: DEPENDENT
              key: 'up_[{#PORT_IDX}]'
              delay: '0'
              history: 90d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: CUSTOM_ERROR
                  error_handler_params: mcaDumpError
                - type: JSONPATH
                  parameters:
                    - '$.port_table[ ?(@.port_idx==''{#PORT_IDX}'')].up.first()'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              tags:
                - tag: Application
                  value: Traffic
          trigger_prototypes:
            - uuid: 587d856db5474af0be30cd1a0be0876d
              expression: 'last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi USG Lite/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi USG Lite/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.25 or avg(/Unifi USG Lite/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.25 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 25%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: INFO
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 50%'
                  expression: 'last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi USG Lite/up_[{#PORT_IDX}],#1)="true" and (  avg(/Unifi USG Lite/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi USG Lite/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.5 )'
            - uuid: 8b1252e993964f76b2e9eed68f381119
              expression: 'last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi USG Lite/up_[{#PORT_IDX}],#1)="true" and (  avg(/Unifi USG Lite/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.5 or avg(/Unifi USG Lite/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.5 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 50%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: WARNING
              dependencies:
                - name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 75%'
                  expression: 'last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi USG Lite/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi USG Lite/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi USG Lite/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.75 )'
            - uuid: b7447cb8759a49f59433534af0d24969
              expression: 'last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)>0 and last(/Unifi USG Lite/up_[{#PORT_IDX}],#1)="true" and ( avg(/Unifi USG Lite/rx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.75 or avg(/Unifi USG Lite/tx_port_[{#PORT_IDX}],{$UNIFI_ALERT_PERIOD})>last(/Unifi USG Lite/connection_speed_[{#PORT_IDX}],#1)*.75 )'
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} above 75%'
              opdata: 'Port Usage is rx:{ITEM.VALUE3} tx:{ITEM.VALUE4}'
              priority: AVERAGE
          graph_prototypes:
            - uuid: aae1543d9b5e401fbaca979ba047e0fd
              name: '{{#PORT_IS_UPLINK}.regsub("true", "Uplink")} {{#PORT_MEDIA}.regsub("SFP", \0)} Port {#PORT_IDX} Port I/O'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi USG Lite'
                    key: 'rx_port_[{#PORT_IDX}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi USG Lite'
                    key: 'tx_port_[{#PORT_IDX}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#LOCAL_PORT_NAME}'
              path: $.local_port_name
            - lld_macro: '{#PORT_IDX}'
              path: $.port_idx
            - lld_macro: '{#PORT_IS_UPLINK}'
              path: $.is_uplink
            - lld_macro: '{#PORT_MEDIA}'
              path: $.media
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.port_table
        - uuid: 6a3d0d8f759e4ab08132c1b88cb09937
          name: 'Temp Discovery'
          type: DEPENDENT
          key: temperature_discovery
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Temperature Discovery'
          item_prototypes:
            - uuid: 3e6b0bd15680483498c0fefee9dba6af
              name: 'Temperature {#TEMP_NAME} ({#TEMP_TYPE})'
              type: DEPENDENT
              key: 'temp_[{#TEMP_NAME}]'
              delay: '0'
              history: 90d
              value_type: FLOAT
              units: C
              preprocessing:
                - type: CHECK_JSON_ERROR
                  parameters:
                    - $.mcaDumpError
                  error_handler: DISCARD_VALUE
                - type: JSONPATH
                  parameters:
                    - '$.temperatures[ ?(@.name == ''{#TEMP_NAME}'' ) ].value.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200'
                  error_handler: CUSTOM_ERROR
                  error_handler_params: 'Incorrect Temperature'
              master_item:
                key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
              trigger_prototypes:
                - uuid: 7a478c32effe4f94b0d3a978cc7485c3
                  expression: 'last(/Unifi USG Lite/temp_[{#TEMP_NAME}],#1)>{$UNIFI_ALERT_TEMP}'
                  name: 'High Temperature for {#TEMP_NAME}'
                  event_name: 'high_temperature_{#TEMP_NAME}'
                  opdata: 'Temperature is {ITEM.VALUE1}C'
                  priority: WARNING
          graph_prototypes:
            - uuid: f8edfae4a7ad4edfa6fa9a0352fea49a
              name: 'Temperature [{#TEMP_NAME}]'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi USG Lite'
                    key: 'temp_[{#TEMP_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "root", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "USG-LITE", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#TEMP_NAME}'
              path: $.name
            - lld_macro: '{#TEMP_TYPE}'
              path: $.type
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.temperatures
      macros:
        - macro: '{$UNIFI_CPU_UTILIZATION_HIGH}'
          value: '75'
        - macro: '{$UNIFI_UDMP_LOAD_AVERAGE_HIGH}'
          value: '8'
        - macro: '{$UNIFI_USER}'
          value: root
          description: 'AP Zabbix SSH Username - UDMP only supports root'
    - uuid: c706ce3839514b87885842955e0865bf
      template: 'Unifi WiFi Site'
      name: 'Unifi WiFi Site'
      description: 'This template is meant to collect WiFi data across all of a site''s APs.  Assign to one of the APs and set the {$AP_GROUP} macro to the name of a group that contains all of the APs you want to aggregate against.'
      groups:
        - name: Patrice
        - name: unifiZabbix
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 08c05c41551148dabe5437bc729f0564
          name: 'Client Count'
          type: CALCULATED
          key: client_count
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          units: clients
          params: 'sum(last_foreach(/*/client_count?[group="{$AP_GROUP}"]))'
          tags:
            - tag: Application
              value: Radio
        - uuid: 24671ab8f5d44096b16f5e5b1dcb9326
          name: mca-dump
          type: EXTERNAL
          key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpValidationError
              error_handler: CUSTOM_ERROR
              error_handler_params: $.mcaDumpValidationError.reason
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpTimeout
              error_handler: DISCARD_VALUE
          tags:
            - tag: Application
              value: Host
        - uuid: 1c4533c25fae47e8a07189c280f8f502
          name: 'Total Reception Wireless Bandwidth'
          type: CALCULATED
          key: total_reception_wireless_bandwidth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          units: bps
          params: 'sum(last_foreach(/*/wireless_reception_bandwidth?[group="{$AP_GROUP}"]))'
          tags:
            - tag: Application
              value: Radio
        - uuid: f8bc0b7fbcea4e108b9339e385ef085f
          name: 'Total Transmission Wireless Bandwidth'
          type: CALCULATED
          key: total_transmission_wireless_bandwidth
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          units: bps
          params: 'sum(last_foreach(/*/wireless_transmission_bandwidth?[group="{$AP_GROUP}"]))'
          tags:
            - tag: Application
              value: Radio
      discovery_rules:
        - uuid: e8e0ef9c01f0409e9a649e0f69ea50cf
          name: 'Discover WiFi Networks'
          type: DEPENDENT
          key: wifi_network_discovery_rule
          delay: '0'
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: 5dec0a594c78406db461df4bb2d5152f
              name: '{#ESSID}-{#RADIO_NAME} Client Count'
              type: CALCULATED
              key: 'client_count[{#ESSID}-{#RADIO_NAME}]'
              history: 90d
              value_type: FLOAT
              units: clients
              params: 'sum(last_foreach(/*/client_count[{#ESSID}-{#RADIO_NAME}]?[group="{$AP_GROUP}"]))'
              tags:
                - tag: Application
                  value: Radio
            - uuid: 460c978a4cfb40b1930c4a47dac748e9
              name: '{#ESSID}-{#RADIO_NAME} Total Reception Bandwidth'
              type: CALCULATED
              key: 'rx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
              history: 90d
              value_type: FLOAT
              units: bps
              params: 'sum(last_foreach(/*/rx_bandwidth[{#ESSID}-{#RADIO_NAME}]?[group="{$AP_GROUP}"]))'
              tags:
                - tag: Application
                  value: Radio
            - uuid: c91e55731b9d4dae8fb3d5d1ab8e1cb0
              name: '{#ESSID}-{#RADIO_NAME} Total Transmission Bandwidth'
              type: CALCULATED
              key: 'tx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
              history: 90d
              value_type: FLOAT
              units: bps
              params: 'sum(last_foreach(/*/tx_bandwidth[{#ESSID}-{#RADIO_NAME}]?[group="{$AP_GROUP}"]))'
              tags:
                - tag: Application
                  value: Radio
          graph_prototypes:
            - uuid: 4487c510b1ad4c5a940cfad9acc63266
              name: '{#ESSID}-{#RADIO_NAME}  Bandwidth'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Unifi WiFi Site'
                    key: 'rx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Unifi WiFi Site'
                    key: 'tx_bandwidth[{#ESSID}-{#RADIO_NAME}]'
            - uuid: ebba8b69c09749c0a5691cfd147bdac5
              name: '{#ESSID}-{#RADIO_NAME}  Clients'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Unifi WiFi Site'
                    key: 'client_count[{#ESSID}-{#RADIO_NAME}]'
          master_item:
            key: 'mca-dump-short.sh["-d","{HOST.CONN}", "-u", "{$UNIFI_USER}", "-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-t", "AP", "-p", "{$UNIFI_SSHPASS_PASSWORD_PATH}", "-o", "{$UNIFI_CHECK_TIMEOUT}","-b"]'
          lld_macro_paths:
            - lld_macro: '{#ESSID}'
              path: $.essid
            - lld_macro: '{#RADIO_NAME}'
              path: $.radio
          preprocessing:
            - type: CHECK_JSON_ERROR
              parameters:
                - $.mcaDumpError
              error_handler: DISCARD_VALUE
            - type: JSONPATH
              parameters:
                - $.vap_table
      macros:
        - macro: '{$AP_GROUP}'
          value: 'Override me!'
          description: 'The name of the group containing the site MAPs'
    - uuid: 072f39c9bbcd485ea94a6761aa8e5a5d
      template: 'Unsupported Item'
      name: 'Unsupported Item'
      groups:
        - name: 'Unifi Zabbix Export'
      items:
        - uuid: 7a317b840d1f4692ab882cd7e9edf619
          name: 'Unsupported Items'
          type: INTERNAL
          key: 'zabbix[host,,items_unsupported]'
          delay: '{$UNIFI_CHECK_FREQUENCY}'
          history: 90d
          triggers:
            - uuid: a0e30c37e9954b52a9427de788cdbb2e
              expression: 'min(/Unsupported Item/zabbix[host,,items_unsupported], {$UNIFI_ALERT_LONG_PERIOD})>0'
              name: '{HOST.NAME} has unsupported item(s)'
              opdata: '{HOST.NAME} has {ITEM.VALUE1} unsupported item(s)'
              priority: INFO
              manual_close: 'YES'
  triggers:
    - uuid: 986b14fb36e8416ca24d2af88b06b613
      expression: 'avg(/Unifi Protect Cloud Key/IpExtInOctets,3600s) < last(/Unifi Protect Cloud Key/incoming_bandwidth_moving_average_threshold,#1)'
      name: '{HOST.NAME} Incoming Bandwidth Too Low'
      opdata: 'Incoming Bandwidth is {ITEM.VALUE1}'
      priority: WARNING
      manual_close: 'YES'
      dependencies:
        - name: '{HOST.NAME} Incoming Bandwidth Problem'
          expression: 'avg(/Unifi Protect Cloud Key/IpExtInOctets,3600s) < 10000'
    - uuid: 8e2e73da9a224f61b24511db3c331864
      expression: 'avg(/Unifi Protect NVR4/IpExtInOctets,1h) < last(/Unifi Protect NVR4/incoming_bandwidth_moving_average_threshold,#1)'
      name: '{HOST.NAME} Incoming Bandwidth Too Low'
      opdata: 'Incoming Bandwidth is {ITEM.VALUE1}'
      priority: WARNING
      manual_close: 'YES'
      dependencies:
        - name: '{HOST.NAME} Incoming Bandwidth Problem'
          expression: 'avg(/Unifi Protect NVR4/IpExtInOctets,1h) < 10000'
    - uuid: 52cec550f270441f9c5cdd764897ce53
      expression: 'last(/Unifi Protect NVR4/ssh.run[temp1],#1)>{$UNIFI_ALERT_TEMP} or last(/Unifi Protect NVR4/ssh.run[temp2],#1)>{$UNIFI_ALERT_TEMP} or last(/Unifi Protect NVR4/ssh.run[temp3],#1)>{$UNIFI_ALERT_TEMP}'
      name: '{HOST.NAME} is hot'
      opdata: 'Temperatures are {ITEM.VALUE1}, {ITEM.VALUE2}, {ITEM.VALUE3}'
      priority: WARNING
    - uuid: fa04116d6e4745838b30da9897dbc46c
      expression: 'last(/Unifi RSA Only SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi RSA Only SSH Host/ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","proc"],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
      name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: WARNING
      manual_close: 'YES'
    - uuid: d71b7c4cdb084f10b4556d2cadd84f8d
      expression: 'last(/Unifi SSH High Priority Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH High Priority Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
      name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: WARNING
      manual_close: 'YES'
    - uuid: 665ee1289cf94f318e26c9e7474e4229
      expression: 'last(/Unifi SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
      name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: WARNING
      manual_close: 'YES'
    - uuid: 45dda2b369c348bf985d6bd53bb82cfe
      expression: 'last(/Unifi RSA Only SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi RSA Only SSH Host/ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","proc"],#1)*{$UNIFI_LOAD_AVERAGE_MEDIUM}'
      name: '{HOST.NAME} Load average is > {$UNIFI_LOAD_AVERAGE_MEDIUM} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: INFO
      manual_close: 'YES'
      dependencies:
        - name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
          expression: 'last(/Unifi RSA Only SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi RSA Only SSH Host/ssh-run.sh["-r","-i", "{$UNIFI_SSH_PRIV_KEY_PATH}", "-u","{$UNIFI_USER}","-d","{HOST.CONN}","proc"],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
    - uuid: b601c0fbee6e48668ec03ff912b5304c
      expression: 'last(/Unifi SSH High Priority Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH High Priority Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_MEDIUM}'
      name: '{HOST.NAME} Load average is > {$UNIFI_LOAD_AVERAGE_MEDIUM} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: INFO
      manual_close: 'YES'
      dependencies:
        - name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
          expression: 'last(/Unifi SSH High Priority Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH High Priority Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
    - uuid: 22986a62ed9b40ec9c89acecff5045fa
      expression: 'last(/Unifi SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_MEDIUM}'
      name: '{HOST.NAME} Load average is > {$UNIFI_LOAD_AVERAGE_MEDIUM} per processor'
      opdata: 'Load Average is {ITEM.VALUE1}'
      priority: INFO
      manual_close: 'YES'
      dependencies:
        - name: '{HOST.NAME} load average is > {$UNIFI_LOAD_AVERAGE_HIGH} per processor'
          expression: 'last(/Unifi SSH Host/load_avg_15mn_uptime,#1)>last(/Unifi SSH Host/ssh.run[nproc],#1)*{$UNIFI_LOAD_AVERAGE_HIGH}'
  graphs:
    - uuid: 6800f3a3becb44ffbabb02587276d1c5
      name: 'Air Time'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'UBNT Airmax'
            key: airTimeSmooth
    - uuid: fad2952510f34a4897c8194393d3e6e3
      name: Bandwidth
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi Protect Camera'
            key: rx_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi Protect Camera'
            key: tx_bandwidth
    - uuid: 97ccfef4197444c69af57ca79513fd16
      name: Bandwidth
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi Protect NVR4'
            key: IpExtInOctets
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi Protect NVR4'
            key: incoming_bandwidth_moving_average_threshold
    - uuid: 0d21337806de4d03bda1b762c0a98ee4
      name: 'Bandwidth and Clients'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi AP'
            key: wireless_reception_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi AP'
            key: wireless_transmission_bandwidth
    - uuid: dd9c1e7a2b6a44a590a8ce1e131e75ed
      name: 'Bandwidth Used'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'UBNT Airmax'
            key: wlanRxBandwidthSmooth
        - sortorder: '2'
          color: F63100
          item:
            host: 'UBNT Airmax'
            key: wlanTxBandwidthSmooth
    - uuid: 8853a3813ca8403eb6199379f8349834
      name: 'Charge and Voltage'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          yaxisside: RIGHT
          item:
            host: 'SunMAX SolarPoint'
            key: batteryCharge
        - sortorder: '2'
          color: F63100
          item:
            host: 'SunMAX SolarPoint'
            key: batteryVoltage
    - uuid: 681748e7fc8c4bde954dca81adc5a453
      name: Clients
      ymin_type_1: FIXED
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Unifi WiFi Site'
            key: client_count
    - uuid: 77b6b90c95ee43ed89899a355d9449f0
      name: 'CPU and Memory'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi Switch'
            key: cpu_smooth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi Switch'
            key: memory
    - uuid: f7f3c8e61e564d0d9f8057f70d9c0072
      name: 'CPU and Memory'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi UDMP'
            key: cpu
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi UDMP'
            key: memory
    - uuid: 347ef23ef5a94b629dabcc89b74331a0
      name: 'CPU and Memory'
      graph_items:
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi USG'
            key: memory
    - uuid: 5d9c3dfd37324b68b9bdec674227c9d6
      name: 'CPU and Memory'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi USG Lite'
            key: cpu
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi USG Lite'
            key: memory
    - uuid: 2cec753f0a24451fb95a06fd19a0ae8d
      name: 'Incoming Bandwidth'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi Protect Cloud Key'
            key: IpExtInOctets
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi Protect Cloud Key'
            key: incoming_bandwidth_moving_average_threshold
    - uuid: d1297e6c07c54ae9af1adf1ac34aa629
      name: 'Load Averages'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi RSA Only SSH Host'
            key: load_avg_1mn_uptime
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi RSA Only SSH Host'
            key: load_avg_15mn_uptime
        - sortorder: '3'
          color: 2774A4
          item:
            host: 'Unifi RSA Only SSH Host'
            key: load_avg_5mn_uptime
    - uuid: cd4b89f3fff24baf877bcf444a62f05d
      name: 'Load Averages'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi SSH High Priority Host'
            key: load_avg_1mn_uptime
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi SSH High Priority Host'
            key: load_avg_15mn_uptime
        - sortorder: '3'
          color: 2774A4
          item:
            host: 'Unifi SSH High Priority Host'
            key: load_avg_5mn_uptime
    - uuid: 47ef7a2c34d24f75bb0453105a57974e
      name: 'Load Averages'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi SSH Host'
            key: load_avg_1mn_uptime
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi SSH Host'
            key: load_avg_15mn_uptime
        - sortorder: '3'
          color: 2774A4
          item:
            host: 'Unifi SSH Host'
            key: load_avg_5mn_uptime
    - uuid: defcfe28a659470c929684a6c51957fe
      name: 'Power I/O'
      graph_items:
        - sortorder: '1'
          color: 2774A4
          item:
            host: 'SunMAX SolarPoint'
            key: net_power_consumption
    - uuid: 01686902f0154cc99cf027792a39adc9
      name: 'Signal and Noise'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'UBNT Airmax'
            key: noiseSmooth
        - sortorder: '2'
          color: F63100
          item:
            host: 'UBNT Airmax'
            key: signalSmooth
    - uuid: febf8b739918467488438aff431f944e
      name: 'Temperature and Fan Speed'
      graph_items:
        - color: 1A7C11
          yaxisside: RIGHT
          item:
            host: 'Unifi UDMP'
            key: fanSpeed
    - uuid: 32f787121dc94a769829896a44364785
      name: 'Total Embedded Switch Bandwidth'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi UDMP'
            key: total_switch_rx_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi UDMP'
            key: total_switch_tx_bandwidth
    - uuid: 4a4bf6b07d94481ba6ab6a8c67986a6f
      name: 'Total Embedded Switch Bandwidth'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi USG Lite'
            key: total_switch_rx_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi USG Lite'
            key: total_switch_tx_bandwidth
    - uuid: 160a7ded8ed04fbdba40c5126962be4a
      name: 'Total Traffic'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi Switch'
            key: total_rx_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi Switch'
            key: total_rx_bandwidth
    - uuid: aa28d9dbd34e4cdfb0e4447dbdb171ef
      name: 'Total WiFi Bandwidth'
      graph_items:
        - sortorder: '1'
          color: 1A7C11
          item:
            host: 'Unifi WiFi Site'
            key: total_reception_wireless_bandwidth
        - sortorder: '2'
          color: F63100
          item:
            host: 'Unifi WiFi Site'
            key: total_transmission_wireless_bandwidth
